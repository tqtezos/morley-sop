<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TypeFamilyDependencies #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# OPTIONS -Wno-missing-export-lists -Wno-unused-type-patterns #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Michelson.Typed.EntryPoints.Sing.Alg.Types</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unwords</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><a href="Control.AltError.html"><span class="hs-identifier">Control.AltError</span></a><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><a href="Data.AltError.html"><span class="hs-identifier">Data.AltError</span></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="Data.ListError.html"><span class="hs-identifier">Data.ListError</span></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Singletons.Map.html"><span class="hs-identifier">Data.Singletons.Map</span></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Singletons.Prelude.Monad.State.html"><span class="hs-identifier">Data.Singletons.Prelude.Monad.State</span></a><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="Michelson.Typed.Annotation.Path.html"><span class="hs-identifier">Michelson.Typed.Annotation.Path</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html"><span class="hs-identifier">Michelson.Typed.Annotation.Sing.Alg</span></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.TH.html"><span class="hs-identifier">Michelson.Typed.Annotation.Sing.Alg.TH</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="Michelson.Typed.EntryPoints.Error.html"><span class="hs-identifier">Michelson.Typed.EntryPoints.Error</span></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="Michelson.Typed.T.Alg.html"><span class="hs-identifier">Michelson.Typed.T.Alg</span></a><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Singletons.TypeLits</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Singletons.Prelude</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-identifier">epFieldRecResolveOr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120651"><a href="#local-6989586621680120651"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120652"><a href="#local-6989586621680120652"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621680120653"><a href="#local-6989586621680120653"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621680120654"><a href="#local-6989586621680120654"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621680120655"><a href="#local-6989586621680120655"><span class="hs-identifier">tb</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120651"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120651"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621680120651"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="Control.AltError.html#AltError"><span class="hs-identifier hs-type">AltError</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120651"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621680120652"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120653"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120651"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-type">TOpq</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120651"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120652"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621680120653"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120651"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120651"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120651"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120654"><span class="hs-identifier hs-type">ta</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120651"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120655"><span class="hs-identifier hs-type">tb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120651"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120651"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120652"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621680120653"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-25"></a><a name="epFieldRecResolveOr"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecResolveOr"><span class="hs-identifier">epFieldRecResolveOr</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680120656"><a href="#local-6989586621680120656"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120657"><a href="#local-6989586621680120657"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120658"><a href="#local-6989586621680120658"><span class="hs-identifier">ta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120659"><a href="#local-6989586621680120659"><span class="hs-identifier">tb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120660"><a href="#local-6989586621680120660"><span class="hs-identifier">aa</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120661"><a href="#local-6989586621680120661"><span class="hs-identifier">ab</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120663"><a href="#local-6989586621680120663"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120664"><a href="#local-6989586621680120664"><span class="hs-identifier">entrypointName</span></a></a><span> </span><a name="local-6989586621680120665"><a href="#local-6989586621680120665"><span class="hs-identifier">epPath</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120666"><a href="#local-6989586621680120666"><span class="hs-identifier">fieldAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bool_</span><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">(</span><a href="Control.AltError.html#altErr"><span class="hs-identifier hs-var">altErr</span></a><span> </span><span class="hs-special">[</span><a href="Michelson.Typed.EntryPoints.Error.html#epFieldRecEntrypointError"><span class="hs-identifier hs-var">epFieldRecEntrypointError</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621680120665"><span class="hs-identifier hs-var">epPath</span></a><span> </span><a href="#local-6989586621680120656"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680120660"><span class="hs-identifier hs-var">aa</span></a><span> </span><a href="#local-6989586621680120664"><span class="hs-identifier hs-var">entrypointName</span></a><span> </span><a href="#local-6989586621680120666"><span class="hs-identifier hs-var">fieldAnn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>    </span><span class="hs-special">(</span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRec%27"><span class="hs-identifier hs-var">epFieldRec'</span></a><span> </span><a href="#local-6989586621680120656"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680120657"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621680120658"><span class="hs-identifier hs-var">ta</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621680120665"><span class="hs-identifier hs-var">epPath</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621680120660"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">(</span><a href="#local-6989586621680120660"><span class="hs-identifier hs-var">aa</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621680120664"><span class="hs-identifier hs-var">entrypointName</span></a><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">)</span><span> </span><a href="Control.AltError.html#%3C%7C%7C%3E"><span class="hs-operator hs-var">&lt;||&gt;</span></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bool_</span><span>
</span><a name="line-32"></a><span>    </span><span class="hs-special">(</span><a href="Control.AltError.html#altErr"><span class="hs-identifier hs-var">altErr</span></a><span> </span><span class="hs-special">[</span><a href="Michelson.Typed.EntryPoints.Error.html#epFieldRecEntrypointError"><span class="hs-identifier hs-var">epFieldRecEntrypointError</span></a><span> </span><a href="#local-6989586621680120663"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621680120665"><span class="hs-identifier hs-var">epPath</span></a><span> </span><a href="#local-6989586621680120656"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680120661"><span class="hs-identifier hs-var">ab</span></a><span> </span><a href="#local-6989586621680120664"><span class="hs-identifier hs-var">entrypointName</span></a><span> </span><a href="#local-6989586621680120666"><span class="hs-identifier hs-var">fieldAnn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>    </span><span class="hs-special">(</span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRec%27"><span class="hs-identifier hs-var">epFieldRec'</span></a><span> </span><a href="#local-6989586621680120656"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680120657"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621680120659"><span class="hs-identifier hs-var">tb</span></a><span> </span><a href="#local-6989586621680120663"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621680120665"><span class="hs-identifier hs-var">epPath</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621680120661"><span class="hs-identifier hs-var">ab</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-special">(</span><a href="#local-6989586621680120661"><span class="hs-identifier hs-var">ab</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621680120664"><span class="hs-identifier hs-var">entrypointName</span></a><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span class="hs-identifier">epFieldRecResolveOr</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120667"><a href="#local-6989586621680120667"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120668"><a href="#local-6989586621680120668"><span class="hs-identifier">_fs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120669"><a href="#local-6989586621680120669"><span class="hs-identifier">_tab</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680120670"><a href="#local-6989586621680120670"><span class="hs-identifier">aa</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120671"><a href="#local-6989586621680120671"><span class="hs-identifier">ab</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120673"><a href="#local-6989586621680120673"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120674"><a href="#local-6989586621680120674"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621680120675"><a href="#local-6989586621680120675"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120676"><a href="#local-6989586621680120676"><span class="hs-identifier">fieldAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-37"></a><span>  </span><a href="Control.AltError.html#altFail"><span class="hs-identifier hs-var">altFail</span></a><span> </span><span class="hs-special">[</span><a href="Michelson.Typed.EntryPoints.Error.html#epFieldRecResolveOrError"><span class="hs-identifier hs-var">epFieldRecResolveOrError</span></a><span> </span><a href="#local-6989586621680120670"><span class="hs-identifier hs-var">aa</span></a><span> </span><a href="#local-6989586621680120671"><span class="hs-identifier hs-var">ab</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621680120673"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120674"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621680120675"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120667"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680120676"><span class="hs-identifier hs-var">fieldAnn</span></a><span class="hs-special">]</span><span>
</span><a name="line-38"></a><span class="hs-identifier">epFieldRecResolveOr</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120677"><a href="#local-6989586621680120677"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120678"><a href="#local-6989586621680120678"><span class="hs-identifier">_fs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120679"><a href="#local-6989586621680120679"><span class="hs-identifier">_tab</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680120680"><a href="#local-6989586621680120680"><span class="hs-identifier">aa</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120681"><a href="#local-6989586621680120681"><span class="hs-identifier">ab</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120683"><a href="#local-6989586621680120683"><span class="hs-identifier">bs</span></a></a><span> </span><a href="Michelson.Typed.Annotation.Path.html#Here"><span class="hs-identifier hs-var">Here</span></a><span> </span><a name="local-6989586621680120684"><a href="#local-6989586621680120684"><span class="hs-identifier">fieldAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-39"></a><span>  </span><a href="Control.AltError.html#altFail"><span class="hs-identifier hs-var">altFail</span></a><span> </span><span class="hs-special">[</span><a href="Michelson.Typed.EntryPoints.Error.html#epFieldRecResolveOrError"><span class="hs-identifier hs-var">epFieldRecResolveOrError</span></a><span> </span><a href="#local-6989586621680120680"><span class="hs-identifier hs-var">aa</span></a><span> </span><a href="#local-6989586621680120681"><span class="hs-identifier hs-var">ab</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621680120683"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="Michelson.Typed.Annotation.Path.html#Here"><span class="hs-identifier hs-var">Here</span></a><span> </span><a href="#local-6989586621680120677"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680120684"><span class="hs-identifier hs-var">fieldAnn</span></a><span class="hs-special">]</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-identifier">epFieldRecResolvePair</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120646"><a href="#local-6989586621680120646"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120647"><a href="#local-6989586621680120647"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621680120648"><a href="#local-6989586621680120648"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621680120649"><a href="#local-6989586621680120649"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621680120650"><a href="#local-6989586621680120650"><span class="hs-identifier">tb</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120646"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120646"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621680120646"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="Control.AltError.html#AltError"><span class="hs-identifier hs-type">AltError</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120646"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621680120647"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120648"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120646"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-type">TOpq</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120646"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120647"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621680120648"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120646"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120646"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120646"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120649"><span class="hs-identifier hs-type">ta</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120646"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120650"><span class="hs-identifier hs-type">tb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120646"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120646"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120647"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621680120648"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-42"></a><a name="epFieldRecResolvePair"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecResolvePair"><span class="hs-identifier">epFieldRecResolvePair</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680120685"><a href="#local-6989586621680120685"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120686"><a href="#local-6989586621680120686"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120687"><a href="#local-6989586621680120687"><span class="hs-identifier">ta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120688"><a href="#local-6989586621680120688"><span class="hs-identifier">tb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120689"><a href="#local-6989586621680120689"><span class="hs-identifier">aa</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120690"><a href="#local-6989586621680120690"><span class="hs-identifier">ab</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120692"><a href="#local-6989586621680120692"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120693"><a href="#local-6989586621680120693"><span class="hs-identifier">epPathA</span></a></a><span> </span><a name="local-6989586621680120694"><a href="#local-6989586621680120694"><span class="hs-identifier">epPathB</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120695"><a href="#local-6989586621680120695"><span class="hs-identifier">_fieldAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-43"></a><span>  </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRec%27"><span class="hs-identifier hs-var">epFieldRec'</span></a><span> </span><a href="#local-6989586621680120685"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680120686"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621680120687"><span class="hs-identifier hs-var">ta</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621680120693"><span class="hs-identifier hs-var">epPathA</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621680120689"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">)</span><span> </span><a href="Control.AltError.html#%3C%7C%7C%3E"><span class="hs-operator hs-var">&lt;||&gt;</span></a><span>
</span><a name="line-44"></a><span>  </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRec%27"><span class="hs-identifier hs-var">epFieldRec'</span></a><span> </span><a href="#local-6989586621680120685"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680120686"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621680120688"><span class="hs-identifier hs-var">tb</span></a><span> </span><a href="#local-6989586621680120692"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621680120694"><span class="hs-identifier hs-var">epPathB</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621680120690"><span class="hs-identifier hs-var">ab</span></a><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span class="hs-identifier">epFieldRecResolvePair</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120696"><a href="#local-6989586621680120696"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120697"><a href="#local-6989586621680120697"><span class="hs-identifier">_fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120698"><a href="#local-6989586621680120698"><span class="hs-identifier">_ta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120699"><a href="#local-6989586621680120699"><span class="hs-identifier">_tb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120700"><a href="#local-6989586621680120700"><span class="hs-identifier">_aa</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120701"><a href="#local-6989586621680120701"><span class="hs-identifier">_ab</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120703"><a href="#local-6989586621680120703"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120704"><a href="#local-6989586621680120704"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621680120705"><a href="#local-6989586621680120705"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120706"><a href="#local-6989586621680120706"><span class="hs-identifier">fieldAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-46"></a><span>  </span><a href="Control.AltError.html#altFail"><span class="hs-identifier hs-var">altFail</span></a><span> </span><span class="hs-special">[</span><a href="Michelson.Typed.EntryPoints.Error.html#epFieldRecResolvePairError"><span class="hs-identifier hs-var">epFieldRecResolvePairError</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621680120703"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120704"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621680120705"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120696"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680120706"><span class="hs-identifier hs-var">fieldAnn</span></a><span class="hs-special">]</span><span>
</span><a name="line-47"></a><span class="hs-identifier">epFieldRecResolvePair</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120707"><a href="#local-6989586621680120707"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120708"><a href="#local-6989586621680120708"><span class="hs-identifier">_fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120709"><a href="#local-6989586621680120709"><span class="hs-identifier">_ta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120710"><a href="#local-6989586621680120710"><span class="hs-identifier">_tb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120711"><a href="#local-6989586621680120711"><span class="hs-identifier">_aa</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120712"><a href="#local-6989586621680120712"><span class="hs-identifier">_ab</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120714"><a href="#local-6989586621680120714"><span class="hs-identifier">bs</span></a></a><span> </span><a href="Michelson.Typed.Annotation.Path.html#Here"><span class="hs-identifier hs-var">Here</span></a><span> </span><a name="local-6989586621680120715"><a href="#local-6989586621680120715"><span class="hs-identifier">fieldAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-48"></a><span>  </span><a href="Control.AltError.html#altFail"><span class="hs-identifier hs-var">altFail</span></a><span> </span><span class="hs-special">[</span><a href="Michelson.Typed.EntryPoints.Error.html#epFieldRecResolvePairError"><span class="hs-identifier hs-var">epFieldRecResolvePairError</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621680120714"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="Michelson.Typed.Annotation.Path.html#Here"><span class="hs-identifier hs-var">Here</span></a><span> </span><a href="#local-6989586621680120707"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680120715"><span class="hs-identifier hs-var">fieldAnn</span></a><span class="hs-special">]</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">-- | `epFieldRec`, where we `Maybe` have an inherited `fieldAnn` (initially `Nothing`)</span><span>
</span><a name="line-51"></a><span class="hs-identifier">epFieldRec'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120642"><a href="#local-6989586621680120642"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120643"><a href="#local-6989586621680120643"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621680120644"><a href="#local-6989586621680120644"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621680120645"><a href="#local-6989586621680120645"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120642"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120642"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621680120642"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="Control.AltError.html#AltError"><span class="hs-identifier hs-type">AltError</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120642"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621680120643"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120644"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120642"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-type">TOpq</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120642"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120643"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621680120644"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120642"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120645"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120642"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120642"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120643"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621680120644"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-52"></a><a name="epFieldRec%27"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRec%27"><span class="hs-identifier">epFieldRec'</span></a></a><span> </span><a name="local-6989586621680120716"><a href="#local-6989586621680120716"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621680120717"><a href="#local-6989586621680120717"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.T.Alg.html#TOr"><span class="hs-identifier hs-var">TOr</span></a><span> </span><a name="local-6989586621680120718"><a href="#local-6989586621680120718"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621680120719"><a href="#local-6989586621680120719"><span class="hs-identifier">tb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Sing.Alg.html#ATOr"><span class="hs-identifier hs-var">ATOr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680120720"><a href="#local-6989586621680120720"><span class="hs-identifier">aa</span></a></a><span> </span><a name="local-6989586621680120721"><a href="#local-6989586621680120721"><span class="hs-identifier">ab</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120723"><a href="#local-6989586621680120723"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120724"><a href="#local-6989586621680120724"><span class="hs-identifier">epPath</span></a></a><span> </span><a name="local-6989586621680120725"><a href="#local-6989586621680120725"><span class="hs-identifier">fieldAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecResolveOr"><span class="hs-identifier hs-var">epFieldRecResolveOr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120716"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120717"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120718"><span class="hs-identifier hs-var">ta</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120719"><span class="hs-identifier hs-var">tb</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120720"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120721"><span class="hs-identifier hs-var">ab</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621680120723"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621680120724"><span class="hs-identifier hs-var">epPath</span></a><span> </span><a href="#local-6989586621680120725"><span class="hs-identifier hs-var">fieldAnn</span></a><span>
</span><a name="line-53"></a><span class="hs-identifier">epFieldRec'</span><span> </span><a name="local-6989586621680120726"><a href="#local-6989586621680120726"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621680120727"><a href="#local-6989586621680120727"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.T.Alg.html#TPair"><span class="hs-identifier hs-var">TPair</span></a><span> </span><a name="local-6989586621680120728"><a href="#local-6989586621680120728"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621680120729"><a href="#local-6989586621680120729"><span class="hs-identifier">tb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Sing.Alg.html#ATPair"><span class="hs-identifier hs-var">ATPair</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680120730"><a href="#local-6989586621680120730"><span class="hs-identifier">aa</span></a></a><span> </span><a name="local-6989586621680120731"><a href="#local-6989586621680120731"><span class="hs-identifier">ab</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120733"><a href="#local-6989586621680120733"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120734"><a href="#local-6989586621680120734"><span class="hs-identifier">epPath</span></a></a><span> </span><a name="local-6989586621680120735"><a href="#local-6989586621680120735"><span class="hs-identifier">fieldAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecResolvePair"><span class="hs-identifier hs-var">epFieldRecResolvePair</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120726"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120727"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120728"><span class="hs-identifier hs-var">ta</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120729"><span class="hs-identifier hs-var">tb</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120730"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120731"><span class="hs-identifier hs-var">ab</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621680120733"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621680120734"><span class="hs-identifier hs-var">epPath</span></a><span> </span><a href="#local-6989586621680120735"><span class="hs-identifier hs-var">fieldAnn</span></a><span>
</span><a name="line-54"></a><span class="hs-identifier">epFieldRec'</span><span> </span><a name="local-6989586621680120736"><a href="#local-6989586621680120736"><span class="hs-identifier">_name</span></a></a><span> </span><a name="local-6989586621680120737"><a href="#local-6989586621680120737"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-var">TOpq</span></a><span> </span><a name="local-6989586621680120738"><a href="#local-6989586621680120738"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Sing.Alg.html#ATOpq"><span class="hs-identifier hs-var">ATOpq</span></a><span> </span><a name="local-6989586621680120739"><a href="#local-6989586621680120739"><span class="hs-identifier">_ta</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680120740"><a href="#local-6989586621680120740"><span class="hs-identifier">epPath</span></a></a><span> </span><a name="local-6989586621680120741"><a href="#local-6989586621680120741"><span class="hs-identifier">fieldAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-identifier hs-var">bool_</span><span> </span><span class="hs-special">(</span><a href="Control.AltError.html#altFail"><span class="hs-identifier hs-var">altFail</span></a><span> </span><span class="hs-special">[</span><a href="Michelson.Typed.EntryPoints.Error.html#epFieldRecAssertHereError"><span class="hs-identifier hs-var">epFieldRecAssertHereError</span></a><span> </span><a href="#local-6989586621680120738"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621680120740"><span class="hs-identifier hs-var">epPath</span></a><span> </span><a href="#local-6989586621680120741"><span class="hs-identifier hs-var">fieldAnn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120740"><span class="hs-identifier hs-var">epPath</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Here"><span class="hs-identifier hs-var">Here</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*&gt;</span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621680120737"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621680120738"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621680120741"><span class="hs-identifier hs-var">fieldAnn</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span class="hs-identifier">epFieldRec'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;epFieldRec' annotation does not match type&quot;</span><span> </span><span class="hs-comment">-- impossible in type-level use case</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">-- | Traverse all EpField's with `AltError` effects</span><span>
</span><a name="line-61"></a><span class="hs-identifier">epFieldRec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120638"><a href="#local-6989586621680120638"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120639"><a href="#local-6989586621680120639"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621680120640"><a href="#local-6989586621680120640"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621680120641"><a href="#local-6989586621680120641"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120638"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120638"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621680120638"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="Control.AltError.html#AltError"><span class="hs-identifier hs-type">AltError</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120638"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621680120639"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120640"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120638"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-type">TOpq</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120638"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120639"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621680120640"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120638"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120641"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120638"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120639"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621680120640"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-62"></a><a name="epFieldRec"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRec"><span class="hs-identifier">epFieldRec</span></a></a><span> </span><a name="local-6989586621680120742"><a href="#local-6989586621680120742"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621680120743"><a href="#local-6989586621680120743"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-6989586621680120744"><a href="#local-6989586621680120744"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621680120745"><a href="#local-6989586621680120745"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621680120746"><a href="#local-6989586621680120746"><span class="hs-identifier">epPath</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRec%27"><span class="hs-identifier hs-var">epFieldRec'</span></a><span> </span><a href="#local-6989586621680120742"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680120743"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621680120744"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621680120745"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621680120746"><span class="hs-identifier hs-var">epPath</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">-- Helper for epFieldT</span><span>
</span><a name="line-65"></a><span class="hs-identifier">epFieldRecT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120636"><a href="#local-6989586621680120636"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120637"><a href="#local-6989586621680120637"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120636"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120636"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621680120636"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="Control.AltError.html#AltError"><span class="hs-identifier hs-type">AltError</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120636"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621680120637"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120636"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-type">TOpq</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120636"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120637"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-type">TOpq</span></a><span>
</span><a name="line-66"></a><a name="epFieldRecT"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecT"><span class="hs-identifier">epFieldRecT</span></a></a><span> </span><a name="local-6989586621680120747"><a href="#local-6989586621680120747"><span class="hs-identifier">fieldName</span></a></a><span> </span><a name="local-6989586621680120748"><a href="#local-6989586621680120748"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621680120749"><a href="#local-6989586621680120749"><span class="hs-identifier">fieldNameA</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-identifier hs-var">bool_</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-special">(</span><a href="Control.AltError.html#altErr"><span class="hs-identifier hs-var">altErr</span></a><span> </span><span class="hs-special">[</span><a href="Michelson.Typed.EntryPoints.Error.html#epFieldTFieldError"><span class="hs-identifier hs-var">epFieldTFieldError</span></a><span> </span><a href="#local-6989586621680120747"><span class="hs-identifier hs-var">fieldName</span></a><span> </span><a href="#local-6989586621680120749"><span class="hs-identifier hs-var">fieldNameA</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621680120748"><span class="hs-identifier hs-var">ta</span></a><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-special">(</span><a href="#local-6989586621680120747"><span class="hs-identifier hs-var">fieldName</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621680120749"><span class="hs-identifier hs-var">fieldNameA</span></a><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- | Specialized `epFieldRecResolveOr` for type applications</span><span>
</span><a name="line-73"></a><span class="hs-identifier">epFieldTResolveOr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120632"><a href="#local-6989586621680120632"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120633"><a href="#local-6989586621680120633"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621680120634"><a href="#local-6989586621680120634"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621680120635"><a href="#local-6989586621680120635"><span class="hs-identifier">tb</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120632"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120632"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621680120632"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="Control.AltError.html#AltError"><span class="hs-identifier hs-type">AltError</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120632"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621680120633"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120632"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120632"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120632"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120634"><span class="hs-identifier hs-type">ta</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120632"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120635"><span class="hs-identifier hs-type">tb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120632"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120632"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120632"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120633"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-type">TOpq</span></a><span>
</span><a name="line-74"></a><a name="epFieldTResolveOr"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldTResolveOr"><span class="hs-identifier">epFieldTResolveOr</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680120750"><a href="#local-6989586621680120750"><span class="hs-identifier">ta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120751"><a href="#local-6989586621680120751"><span class="hs-identifier">tb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120752"><a href="#local-6989586621680120752"><span class="hs-identifier">aa</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120753"><a href="#local-6989586621680120753"><span class="hs-identifier">ab</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120755"><a href="#local-6989586621680120755"><span class="hs-identifier">bs</span></a></a><span> </span><a name="local-6989586621680120756"><a href="#local-6989586621680120756"><span class="hs-identifier">epPath</span></a></a><span> </span><a name="local-6989586621680120757"><a href="#local-6989586621680120757"><span class="hs-identifier">fieldName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecResolveOr"><span class="hs-identifier hs-var">epFieldRecResolveOr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120757"><span class="hs-identifier hs-var">fieldName</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecT"><span class="hs-identifier hs-var">epFieldRecT</span></a><span> </span><a href="#local-6989586621680120757"><span class="hs-identifier hs-var">fieldName</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120750"><span class="hs-identifier hs-var">ta</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120751"><span class="hs-identifier hs-var">tb</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120752"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120753"><span class="hs-identifier hs-var">ab</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621680120755"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621680120756"><span class="hs-identifier hs-var">epPath</span></a><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">-- | Specialized `epFieldRecResolvePair` for type applications</span><span>
</span><a name="line-77"></a><span class="hs-identifier">epFieldTResolvePair</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120628"><a href="#local-6989586621680120628"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120629"><a href="#local-6989586621680120629"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621680120630"><a href="#local-6989586621680120630"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621680120631"><a href="#local-6989586621680120631"><span class="hs-identifier">tb</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120628"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120628"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621680120628"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="Control.AltError.html#AltError"><span class="hs-identifier hs-type">AltError</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120628"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621680120629"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120628"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120628"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120628"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120630"><span class="hs-identifier hs-type">ta</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120628"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120631"><span class="hs-identifier hs-type">tb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120628"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120628"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120628"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120629"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-type">TOpq</span></a><span>
</span><a name="line-78"></a><a name="epFieldTResolvePair"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldTResolvePair"><span class="hs-identifier">epFieldTResolvePair</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680120758"><a href="#local-6989586621680120758"><span class="hs-identifier">ta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120759"><a href="#local-6989586621680120759"><span class="hs-identifier">tb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680120760"><a href="#local-6989586621680120760"><span class="hs-identifier">aa</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120761"><a href="#local-6989586621680120761"><span class="hs-identifier">ab</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120763"><a href="#local-6989586621680120763"><span class="hs-identifier">bs</span></a></a><span> </span><a name="local-6989586621680120764"><a href="#local-6989586621680120764"><span class="hs-identifier">epPath</span></a></a><span> </span><a name="local-6989586621680120765"><a href="#local-6989586621680120765"><span class="hs-identifier">fieldName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecResolvePair"><span class="hs-identifier hs-var">epFieldRecResolvePair</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120765"><span class="hs-identifier hs-var">fieldName</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecT"><span class="hs-identifier hs-var">epFieldRecT</span></a><span> </span><a href="#local-6989586621680120765"><span class="hs-identifier hs-var">fieldName</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120758"><span class="hs-identifier hs-var">ta</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120759"><span class="hs-identifier hs-var">tb</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120760"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120761"><span class="hs-identifier hs-var">ab</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621680120763"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621680120764"><span class="hs-identifier hs-var">epPath</span></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- | The type of an entrypoint field (helper)</span><span>
</span><a name="line-81"></a><span class="hs-identifier">epFieldT'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120625"><a href="#local-6989586621680120625"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120626"><a href="#local-6989586621680120626"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621680120627"><a href="#local-6989586621680120627"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120625"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120625"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621680120625"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="Control.AltError.html#AltError"><span class="hs-identifier hs-type">AltError</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120625"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621680120626"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120625"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120627"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120625"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120625"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120625"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120626"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-type">TOpq</span></a><span>
</span><a name="line-82"></a><a name="epFieldT%27"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldT%27"><span class="hs-identifier">epFieldT'</span></a></a><span> </span><a name="local-6989586621680120766"><a href="#local-6989586621680120766"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621680120767"><a href="#local-6989586621680120767"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621680120768"><a href="#local-6989586621680120768"><span class="hs-identifier">epPath</span></a></a><span> </span><a name="local-6989586621680120769"><a href="#local-6989586621680120769"><span class="hs-identifier">fieldName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRec%27"><span class="hs-identifier hs-var">epFieldRec'</span></a><span> </span><a href="#local-6989586621680120769"><span class="hs-identifier hs-var">fieldName</span></a><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecT"><span class="hs-identifier hs-var">epFieldRecT</span></a><span> </span><a href="#local-6989586621680120769"><span class="hs-identifier hs-var">fieldName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120766"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621680120767"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621680120768"><span class="hs-identifier hs-var">epPath</span></a><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-comment">-- | The type of an entrypoint field</span><span>
</span><a name="line-85"></a><span class="hs-identifier">epFieldT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120622"><a href="#local-6989586621680120622"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120623"><a href="#local-6989586621680120623"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621680120624"><a href="#local-6989586621680120624"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120622"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120622"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621680120622"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="Control.AltError.html#AltError"><span class="hs-identifier hs-type">AltError</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120622"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621680120623"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120622"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120624"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120622"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120622"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120623"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-type">TOpq</span></a><span>
</span><a name="line-86"></a><a name="epFieldT"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldT"><span class="hs-identifier">epFieldT</span></a></a><span> </span><a name="local-6989586621680120770"><a href="#local-6989586621680120770"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621680120771"><a href="#local-6989586621680120771"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621680120772"><a href="#local-6989586621680120772"><span class="hs-identifier">epPath</span></a></a><span> </span><a name="local-6989586621680120773"><a href="#local-6989586621680120773"><span class="hs-identifier">fieldName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRec"><span class="hs-identifier hs-var">epFieldRec</span></a><span> </span><a href="#local-6989586621680120773"><span class="hs-identifier hs-var">fieldName</span></a><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecT"><span class="hs-identifier hs-var">epFieldRecT</span></a><span> </span><a href="#local-6989586621680120773"><span class="hs-identifier hs-var">fieldName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120770"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621680120771"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621680120772"><span class="hs-identifier hs-var">epPath</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">-- | helper for epFields</span><span>
</span><a name="line-90"></a><span class="hs-identifier">epFieldRecFields</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120620"><a href="#local-6989586621680120620"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120621"><a href="#local-6989586621680120621"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span> </span><a href="Control.AltError.html#AltError"><span class="hs-identifier hs-type">AltError</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120620"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621680120621"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-type">TOpq</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120620"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120621"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120620"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><a name="epFieldRecFields"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecFields"><span class="hs-identifier">epFieldRecFields</span></a></a><span> </span><a name="local-6989586621680120774"><a href="#local-6989586621680120774"><span class="hs-identifier">_t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-comment">-- | All entrypoint field names</span><span>
</span><a name="line-94"></a><span class="hs-identifier">epFieldNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120617"><a href="#local-6989586621680120617"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120618"><a href="#local-6989586621680120618"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621680120619"><a href="#local-6989586621680120619"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120617"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120617"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621680120617"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="Control.AltError.html#AltError"><span class="hs-identifier hs-type">AltError</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120617"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621680120618"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120617"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120619"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120617"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120618"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120617"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><a name="epFieldNames"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldNames"><span class="hs-identifier">epFieldNames</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRec"><span class="hs-identifier hs-var">epFieldRec</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-string">&quot;epFieldNames&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldRecFields"><span class="hs-identifier hs-var">epFieldRecFields</span></a><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- | All entrypoint field names, in ErrM</span><span>
</span><a name="line-99"></a><span class="hs-identifier">epFieldNamesErrM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120615"><a href="#local-6989586621680120615"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120616"><a href="#local-6989586621680120616"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120615"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120615"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621680120615"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120615"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120616"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120615"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.AltError.html#AltE"><span class="hs-identifier hs-type">AltE</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120615"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621680120615"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-100"></a><a name="epFieldNamesErrM"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldNamesErrM"><span class="hs-identifier">epFieldNamesErrM</span></a></a><span> </span><a name="local-6989586621680120775"><a href="#local-6989586621680120775"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621680120776"><a href="#local-6989586621680120776"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621680120777"><a href="#local-6989586621680120777"><span class="hs-identifier">epPath</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sort</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.ListError.html#listEToAltE"><span class="hs-identifier hs-var">listEToAltE</span></a><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldNames"><span class="hs-identifier hs-var">epFieldNames</span></a><span> </span><a href="#local-6989586621680120775"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621680120776"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621680120777"><span class="hs-identifier hs-var">epPath</span></a><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-comment">-- | EpField types</span><span>
</span><a name="line-103"></a><span class="hs-identifier">epFieldTs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120613"><a href="#local-6989586621680120613"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120614"><a href="#local-6989586621680120614"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120613"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621680120613"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621680120613"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Michelson.Typed.T.Alg.html#TAlg"><span class="hs-identifier hs-type">TAlg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120613"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120614"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120613"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.AltError.html#AltE"><span class="hs-identifier hs-type">AltE</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680120613"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="Michelson.Typed.T.Alg.html#TOpq"><span class="hs-identifier hs-type">TOpq</span></a><span class="hs-special">]</span><span>
</span><a name="line-104"></a><a name="epFieldTs"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldTs"><span class="hs-identifier">epFieldTs</span></a></a><span> </span><a name="local-6989586621680120778"><a href="#local-6989586621680120778"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621680120779"><a href="#local-6989586621680120779"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621680120780"><a href="#local-6989586621680120780"><span class="hs-identifier">epPath</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-105"></a><span>  </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldNamesErrM"><span class="hs-identifier hs-var">epFieldNamesErrM</span></a><span> </span><a href="#local-6989586621680120778"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621680120779"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621680120780"><span class="hs-identifier hs-var">epPath</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span>
</span><a name="line-106"></a><span>  </span><span class="hs-identifier hs-var">traverse</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epFieldT"><span class="hs-identifier hs-var">epFieldT</span></a><span> </span><a href="#local-6989586621680120778"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621680120779"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621680120780"><span class="hs-identifier hs-var">epPath</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">-- All EpPath's, unsorted</span><span>
</span><a name="line-110"></a><span class="hs-identifier">epPathsRaw</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120611"><a href="#local-6989586621680120611"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120612"><a href="#local-6989586621680120612"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120611"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120612"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120611"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-111"></a><a name="epPathsRaw"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epPathsRaw"><span class="hs-identifier">epPathsRaw</span></a></a><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Sing.Alg.html#ATOr"><span class="hs-identifier hs-var">ATOr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680120781"><a href="#local-6989586621680120781"><span class="hs-identifier">aa</span></a></a><span> </span><a name="local-6989586621680120782"><a href="#local-6989586621680120782"><span class="hs-identifier">ab</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120784"><a href="#local-6989586621680120784"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-112"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120781"><span class="hs-identifier hs-var">aa</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epPathsRaw"><span class="hs-identifier hs-var">epPathsRaw</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120782"><span class="hs-identifier hs-var">ab</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epPathsRaw"><span class="hs-identifier hs-var">epPathsRaw</span></a><span> </span><a href="#local-6989586621680120784"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span class="hs-identifier">epPathsRaw</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Sing.Alg.html#ATPair"><span class="hs-identifier hs-var">ATPair</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120786"><a href="#local-6989586621680120786"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epPathsRaw"><span class="hs-identifier hs-var">epPathsRaw</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epPathsRaw"><span class="hs-identifier hs-var">epPathsRaw</span></a><span> </span><a href="#local-6989586621680120786"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span class="hs-identifier">epPathsRaw</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Sing.Alg.html#ATOpq"><span class="hs-identifier hs-var">ATOpq</span></a><span> </span><a name="local-6989586621680120787"><a href="#local-6989586621680120787"><span class="hs-identifier">_ta</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Michelson.Typed.Annotation.Path.html#Here"><span class="hs-identifier hs-var">Here</span></a><span class="hs-special">]</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- All EpPath's, sorted</span><span>
</span><a name="line-118"></a><span class="hs-identifier">epPaths</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120609"><a href="#local-6989586621680120609"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120610"><a href="#local-6989586621680120610"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621680120609"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120609"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120610"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120609"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-119"></a><a name="epPaths"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epPaths"><span class="hs-identifier">epPaths</span></a></a><span> </span><a name="local-6989586621680120788"><a href="#local-6989586621680120788"><span class="hs-identifier">ann</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sort</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#epPathsRaw"><span class="hs-identifier hs-var">epPathsRaw</span></a><span> </span><a href="#local-6989586621680120788"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-identifier">traverseEpPaths</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120606"><a href="#local-6989586621680120606"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621680120607"><a href="#local-6989586621680120607"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120608"><a href="#local-6989586621680120608"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120606"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120606"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#State%27"><span class="hs-identifier hs-type">State'</span></a><span> </span><a href="#local-6989586621680120607"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120606"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120606"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621680120608"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#State%27"><span class="hs-identifier hs-type">State'</span></a><span> </span><a href="#local-6989586621680120607"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120606"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621680120608"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><a name="traverseEpPaths"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#traverseEpPaths"><span class="hs-identifier">traverseEpPaths</span></a></a><span> </span><a name="local-6989586621680120789"><a href="#local-6989586621680120789"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Sing.Alg.html#ATOr"><span class="hs-identifier hs-var">ATOr</span></a><span> </span><a name="local-6989586621680120790"><a href="#local-6989586621680120790"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621680120791"><a href="#local-6989586621680120791"><span class="hs-identifier">aa</span></a></a><span> </span><a name="local-6989586621680120792"><a href="#local-6989586621680120792"><span class="hs-identifier">ab</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120794"><a href="#local-6989586621680120794"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621680120789"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="Michelson.Typed.Annotation.Path.html#Here"><span class="hs-identifier hs-var">Here</span></a><span> </span><a href="#local-6989586621680120791"><span class="hs-identifier hs-var">aa</span></a><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#%3E%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621680120795"><a href="#local-6989586621680120795"><span class="hs-identifier">aa'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-124"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621680120789"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="Michelson.Typed.Annotation.Path.html#Here"><span class="hs-identifier hs-var">Here</span></a><span> </span><a href="#local-6989586621680120792"><span class="hs-identifier hs-var">ab</span></a><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#%3E%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621680120796"><a href="#local-6989586621680120796"><span class="hs-identifier">ab'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-125"></a><span>  </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#ATOr"><span class="hs-identifier hs-var">ATOr</span></a><span> </span><a href="#local-6989586621680120790"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621680120795"><span class="hs-identifier hs-var">aa'</span></a><span> </span><a href="#local-6989586621680120796"><span class="hs-identifier hs-var">ab'</span></a><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#%3C%24%24%3E"><span class="hs-operator hs-var">&lt;$$&gt;</span></a><span>
</span><a name="line-126"></a><span>  </span><span class="hs-special">(</span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#traverseEpPaths"><span class="hs-identifier hs-var">traverseEpPaths</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120789"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120795"><span class="hs-identifier hs-var">aa'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#%3C%3C%2A%3E%3E"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a><span>
</span><a name="line-127"></a><span>  </span><span class="hs-special">(</span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#traverseEpPaths"><span class="hs-identifier hs-var">traverseEpPaths</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120789"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120796"><span class="hs-identifier hs-var">ab'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120794"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>  </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span class="hs-identifier">traverseEpPaths</span><span> </span><a name="local-6989586621680120797"><a href="#local-6989586621680120797"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Sing.Alg.html#ATPair"><span class="hs-identifier hs-var">ATPair</span></a><span> </span><a name="local-6989586621680120798"><a href="#local-6989586621680120798"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621680120799"><a href="#local-6989586621680120799"><span class="hs-identifier">aa</span></a></a><span> </span><a name="local-6989586621680120800"><a href="#local-6989586621680120800"><span class="hs-identifier">ab</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621680120802"><a href="#local-6989586621680120802"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621680120797"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="Michelson.Typed.Annotation.Path.html#Here"><span class="hs-identifier hs-var">Here</span></a><span> </span><a href="#local-6989586621680120799"><span class="hs-identifier hs-var">aa</span></a><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#%3E%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621680120803"><a href="#local-6989586621680120803"><span class="hs-identifier">aa'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621680120797"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="Michelson.Typed.Annotation.Path.html#Here"><span class="hs-identifier hs-var">Here</span></a><span> </span><a href="#local-6989586621680120800"><span class="hs-identifier hs-var">ab</span></a><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#%3E%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621680120804"><a href="#local-6989586621680120804"><span class="hs-identifier">ab'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-132"></a><span>  </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#ATPair"><span class="hs-identifier hs-var">ATPair</span></a><span> </span><a href="#local-6989586621680120798"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621680120803"><span class="hs-identifier hs-var">aa'</span></a><span> </span><a href="#local-6989586621680120804"><span class="hs-identifier hs-var">ab'</span></a><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#%3C%24%24%3E"><span class="hs-operator hs-var">&lt;$$&gt;</span></a><span>
</span><a name="line-133"></a><span>  </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#traverseEpPaths"><span class="hs-identifier hs-var">traverseEpPaths</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120797"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a><span class="hs-special">)</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Here"><span class="hs-identifier hs-var">Here</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#%3C%3C%2A%3E%3E"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a><span>
</span><a name="line-134"></a><span>  </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#traverseEpPaths"><span class="hs-identifier hs-var">traverseEpPaths</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680120797"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Path.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a><span class="hs-special">)</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Here"><span class="hs-identifier hs-var">Here</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120802"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-comment">-- Here is used as a collection of all other paths</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span class="hs-identifier">traverseEpPaths</span><span> </span><a name="local-6989586621680120805"><a href="#local-6989586621680120805"><span class="hs-identifier">_fs</span></a></a><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Sing.Alg.html#ATOpq"><span class="hs-identifier hs-var">ATOpq</span></a><span> </span><a name="local-6989586621680120806"><a href="#local-6989586621680120806"><span class="hs-identifier">ta</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#pureState%27"><span class="hs-identifier hs-var">pureState'</span></a><span> </span><span class="hs-special">(</span><a href="Michelson.Typed.Annotation.Sing.Alg.html#ATOpq"><span class="hs-identifier hs-var">ATOpq</span></a><span> </span><a href="#local-6989586621680120806"><span class="hs-identifier hs-var">ta</span></a><span class="hs-special">)</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-comment">-- count the number of occurrences of the path, then append &quot;_n&quot; if non-zero.</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- skip non-pair-field empty annotations</span><span>
</span><a name="line-140"></a><span class="hs-identifier">uniqifyEpPathsStepSimple</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120605"><a href="#local-6989586621680120605"><span class="hs-identifier">s</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621680120605"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120605"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Semigroup</span><span> </span><a href="#local-6989586621680120605"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a><span> </span><a href="#local-6989586621680120605"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680120605"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#State%27"><span class="hs-identifier hs-type">State'</span></a><span> </span><span class="hs-special">(</span><a href="Data.Singletons.Map.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="#local-6989586621680120605"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680120605"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-141"></a><a name="uniqifyEpPathsStepSimple"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#uniqifyEpPathsStepSimple"><span class="hs-identifier">uniqifyEpPathsStepSimple</span></a></a><span> </span><a name="local-6989586621680120807"><a href="#local-6989586621680120807"><span class="hs-identifier">_epPath</span></a></a><span> </span><a name="local-6989586621680120808"><a href="#local-6989586621680120808"><span class="hs-identifier">annotation</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-special">(</span><a href="Data.Singletons.Map.html#lookupModifyListMap"><span class="hs-identifier hs-var">lookupModifyListMap</span></a><span>
</span><a name="line-143"></a><span>    </span><span class="hs-number">0</span><span>
</span><a name="line-144"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680120809"><a href="#local-6989586621680120809"><span class="hs-identifier">numAtPath</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-145"></a><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">bool_</span><span>
</span><a name="line-146"></a><span>          </span><span class="hs-special">(</span><a href="#local-6989586621680120808"><span class="hs-identifier hs-var">annotation</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;_&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show_</span><span> </span><a href="#local-6989586621680120809"><span class="hs-identifier hs-var">numAtPath</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>          </span><a href="#local-6989586621680120808"><span class="hs-identifier hs-var">annotation</span></a><span>
</span><a name="line-148"></a><span>          </span><span class="hs-special">(</span><a href="#local-6989586621680120809"><span class="hs-identifier hs-var">numAtPath</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680120809"><span class="hs-identifier hs-var">numAtPath</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-150"></a><span>      </span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>    </span><a href="#local-6989586621680120808"><span class="hs-identifier hs-var">annotation</span></a><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#%3C%24%24%3E"><span class="hs-operator hs-var">&lt;$$&gt;</span></a><span>
</span><a name="line-153"></a><span>    </span><a href="Data.Singletons.Prelude.Monad.State.html#getState%27"><span class="hs-identifier hs-var">getState'</span></a><span>
</span><a name="line-154"></a><span>    </span><span class="hs-special">)</span><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#%3E%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621680120810"><a href="#local-6989586621680120810"><span class="hs-identifier">annotation'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680120811"><a href="#local-6989586621680120811"><span class="hs-identifier">pathsMap'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-155"></a><span>      </span><a href="Data.Singletons.Prelude.Monad.State.html#putState%27"><span class="hs-identifier hs-var">putState'</span></a><span> </span><a href="#local-6989586621680120811"><span class="hs-identifier hs-var">pathsMap'</span></a><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#%2A%3E%3E"><span class="hs-operator hs-var">*&gt;&gt;</span></a><span> </span><a href="Data.Singletons.Prelude.Monad.State.html#pureState%27"><span class="hs-identifier hs-var">pureState'</span></a><span> </span><a href="#local-6989586621680120810"><span class="hs-identifier hs-var">annotation'</span></a><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-identifier">uniqifyEpPathsSimpler</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680120603"><a href="#local-6989586621680120603"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680120604"><a href="#local-6989586621680120604"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621680120603"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="#local-6989586621680120603"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Semigroup</span><span> </span><a href="#local-6989586621680120603"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120603"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120604"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Typed.Annotation.Sing.Alg.html#AnnotatedAlg"><span class="hs-identifier hs-type">AnnotatedAlg</span></a><span> </span><a href="#local-6989586621680120603"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621680120604"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-158"></a><a name="uniqifyEpPathsSimpler"><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#uniqifyEpPathsSimpler"><span class="hs-identifier">uniqifyEpPathsSimpler</span></a></a><span> </span><a name="local-6989586621680120812"><a href="#local-6989586621680120812"><span class="hs-identifier">ann</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-159"></a><span>  </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#traverseEpPaths"><span class="hs-identifier hs-var">traverseEpPaths</span></a><span> </span><a href="Michelson.Typed.EntryPoints.Sing.Alg.Types.html#uniqifyEpPathsStepSimple"><span class="hs-identifier hs-var">uniqifyEpPathsStepSimple</span></a><span> </span><a href="#local-6989586621680120812"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-special">`</span><a href="Data.Singletons.Prelude.Monad.State.html#evalState%27"><span class="hs-identifier hs-var">evalState'</span></a><span class="hs-special">`</span><span>
</span><a name="line-160"></a><span>  </span><a href="Data.Singletons.Map.html#emptyListMap"><span class="hs-identifier hs-var">emptyListMap</span></a><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">{-
$(singletonsOnly [d|
  -- (current path -&gt; isPairField -&gt; fieldName -&gt; newFieldName)
  -- traverseEpPaths :: forall s t. (EpPath -&gt; Bool -&gt; Symbol -&gt; State' s Symbol) -&gt; SymAnn t -&gt; State' s (SymAnn t)
  -- traverseEpPaths :: forall s t. (EpPath -&gt; Bool -&gt; Symbol -&gt; State' s Symbol) -&gt; SymAnn t -&gt; State' s (SymAnn t)
  -- traverseEpPaths fs (ATOr ann aa ab as bs) =
  --   (fs Here False aa &gt;&gt;&gt;= \aa' -&gt;
  --   (fs Here False ab &gt;&gt;&gt;= \ab' -&gt;
  --   ATOr ann aa' ab' &lt;$$&gt;
  --   (traverseEpPaths (fs . ((:+) aa')) as) &lt;&lt;*&gt;&gt;
  --   (traverseEpPaths (fs . ((:+) ab')) bs)
  --   ))
  -- traverseEpPaths fs (ATPair ann aa ab as bs) =
  --   (fs Here True aa &gt;&gt;&gt;= \aa' -&gt;
  --   (fs Here True ab &gt;&gt;&gt;= \ab' -&gt;
  --   ATPair ann aa' ab' &lt;$$&gt;
  --   traverseEpPaths fs as &lt;&lt;*&gt;&gt;
  --   traverseEpPaths fs bs
  --   ))
  -- traverseEpPaths _fs (ATOpq ta) = pureState' (ATOpq ta)

  -- count the number of occurrences of the path, then append &quot;_n&quot; if non-zero.
  -- skip non-pair-field empty annotations
  uniqifyEpPathsStep :: EpPath -&gt; Symbol -&gt; State' (ListMap (EpPath, Symbol) Nat) Symbol
  uniqifyEpPathsStep epPath annotation = -- _isPairField
    bool_
      ((lookupModifyListMap
        0
        (\numAtPath -&gt;
          ( bool_
              (annotation &lt;&gt; &quot;_&quot; &lt;&gt; show_ numAtPath)
              annotation
              (numAtPath == 0)
          , numAtPath + 1
          )
        )
        (epPath, annotation) &lt;$$&gt;
        getState'
        ) &gt;&gt;&gt;= \(annotation', pathsMap') -&gt;
          putState' pathsMap' *&gt;&gt; pureState' annotation'
      )
      (pureState' annotation)
      -- (annotation == &quot;&quot; &amp;&amp; not isPairField)
      False

  uniqifyEpPaths :: forall t. SymAnn t -&gt; SymAnn t
  uniqifyEpPaths ann =
    traverseEpPaths uniqifyEpPathsStep ann `evalState'`
    emptyListMap

  uniqifyWithA :: Symbol -&gt; Symbol -&gt; Symbol
  uniqifyWithA x y =
    bool_
      x
      (x &lt;&gt; &quot;_1&quot;)
      (x == y)

  uniqifyWithB :: Symbol -&gt; Symbol -&gt; Symbol
  uniqifyWithB x y =
    bool_
      x
      (x &lt;&gt; &quot;_2&quot;)
      (x == y)

  uniqifyEpPathsSimple :: forall t. SymAnn t -&gt; SymAnn t
  uniqifyEpPathsSimple (ATOr ann aa ab as bs) =
    ATOr
      ann
      (aa `uniqifyWithA` ab)
      (ab `uniqifyWithB` aa)
      (uniqifyEpPathsSimple as)
      (uniqifyEpPathsSimple bs)
  uniqifyEpPathsSimple (ATPair ann aa ab as bs) =
    ATPair
      ann
      (aa `uniqifyWithA` ab)
      (ab `uniqifyWithB` aa)
      (uniqifyEpPathsSimple as)
      (uniqifyEpPathsSimple bs)
  uniqifyEpPathsSimple (ATOpq ta) = ATOpq ta

  |])
-}</span><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a></pre></body></html>