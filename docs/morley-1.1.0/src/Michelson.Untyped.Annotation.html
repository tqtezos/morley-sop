<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Michelson annotations in untyped model.</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Michelson.Untyped.Annotation</span><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-var">Annotation</span></a><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><a href="Michelson.Untyped.Annotation.html#WithAnn"><span class="hs-identifier hs-var">WithAnn</span></a><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span>  </span><span class="hs-comment">-- * Annotation Set</span><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#emptyAnnSet"><span class="hs-identifier hs-var">emptyAnnSet</span></a><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#fullAnnSet"><span class="hs-identifier hs-var">fullAnnSet</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#isNoAnnSet"><span class="hs-identifier hs-var">isNoAnnSet</span></a><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#minAnnSetSize"><span class="hs-identifier hs-var">minAnnSetSize</span></a><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#singleAnnSet"><span class="hs-identifier hs-var">singleAnnSet</span></a><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#singleGroupAnnSet"><span class="hs-identifier hs-var">singleGroupAnnSet</span></a><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-comment">-- * Rendering</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#KnownAnnTag"><span class="hs-identifier hs-type">KnownAnnTag</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#TypeAnn"><span class="hs-identifier hs-type">TypeAnn</span></a><span>
</span><a name="line-20"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#FieldAnn"><span class="hs-identifier hs-type">FieldAnn</span></a><span>
</span><a name="line-21"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#VarAnn"><span class="hs-identifier hs-type">VarAnn</span></a><span>
</span><a name="line-22"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#SomeAnn"><span class="hs-identifier hs-type">SomeAnn</span></a><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span>  </span><span class="hs-comment">-- * Creation and conversions</span><span>
</span><a name="line-25"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#ann"><span class="hs-identifier hs-var">ann</span></a><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#mkAnnotation"><span class="hs-identifier hs-var">mkAnnotation</span></a><span>
</span><a name="line-28"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#specialVarAnns"><span class="hs-identifier hs-var">specialVarAnns</span></a><span>
</span><a name="line-29"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#specialFieldAnn"><span class="hs-identifier hs-var">specialFieldAnn</span></a><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#isValidAnnStart"><span class="hs-identifier hs-var">isValidAnnStart</span></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#isValidAnnBodyChar"><span class="hs-identifier hs-var">isValidAnnBodyChar</span></a><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#unifyAnn"><span class="hs-identifier hs-var">unifyAnn</span></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#ifAnnUnified"><span class="hs-identifier hs-var">ifAnnUnified</span></a><span>
</span><a name="line-34"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#disjoinVn"><span class="hs-identifier hs-var">disjoinVn</span></a><span>
</span><a name="line-35"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#convAnn"><span class="hs-identifier hs-var">convAnn</span></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Aeson.TH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">defaultOptions</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">deriveJSON</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Char</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isAlpha</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isAscii</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isNumber</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Default</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Default</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Kind</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Kind</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Typeable</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-type">:~:</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">eqT</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Fmt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Buildable</span><span class="hs-special">(</span><span class="hs-identifier hs-var">build</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Instances.TH.Lift</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Lift</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">deriveLift</span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.PrettyPrint.Leijen.Text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Doc</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;+&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">hsep</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">textStrict</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Text.Show</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><a href="Michelson.Printer.Util.html"><span class="hs-identifier">Michelson.Printer.Util</span></a><span> </span><span class="hs-special">(</span><a href="Michelson.Printer.Util.html#RenderDoc"><span class="hs-identifier hs-type">RenderDoc</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Michelson.Printer.Util.html#buildRenderDoc"><span class="hs-identifier hs-var">buildRenderDoc</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Printer.Util.html#doesntNeedParens"><span class="hs-identifier hs-var">doesntNeedParens</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Printer.Util.html#printDocS"><span class="hs-identifier hs-var">printDocS</span></a><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- | Generic Type/Field/Variable Annotation</span><span>
</span><a name="line-54"></a><span class="hs-comment">--</span><span>
</span><a name="line-55"></a><span class="hs-comment">-- As per Michelson documentation, this type has an invariant:</span><span>
</span><a name="line-56"></a><span class="hs-comment">-- (except for the first character, here parametrized in the type `tag`) the</span><span>
</span><a name="line-57"></a><span class="hs-comment">-- allowed character set is the one matching the following regexp:</span><span>
</span><a name="line-58"></a><span class="hs-comment">-- @%|@%%|%@|[@:%][_a-zA-Z][_0-9a-zA-Z\.%@]*</span><span>
</span><a name="line-59"></a><span class="hs-keyword">newtype</span><span> </span><a name="Annotation"><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier">Annotation</span></a></a><span> </span><a name="local-6989586621679159830"><a href="#local-6989586621679159830"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="AnnotationUnsafe"><a href="Michelson.Untyped.Annotation.html#AnnotationUnsafe"><span class="hs-identifier">AnnotationUnsafe</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unAnnotation"><a href="Michelson.Untyped.Annotation.html#unAnnotation"><span class="hs-identifier">unAnnotation</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-60"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159849"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-keyword">pattern</span><span> </span><span class="hs-identifier">Annotation</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159863"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-66"></a><span class="hs-keyword">pattern</span><span> </span><a name="Annotation"><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier">Annotation</span></a></a><span> </span><a href="#local-6989586621679159864"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationUnsafe"><span class="hs-identifier hs-var">AnnotationUnsafe</span></a><span> </span><a name="local-6989586621679159864"><a href="#local-6989586621679159864"><span class="hs-identifier">ann</span></a></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="hs-pragma">Annotation</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Annotation</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Default</span><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159848"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-71"></a><span>  </span><a name="local-8214565720323800136"><span class="hs-identifier">def</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-74"></a><span class="hs-comment">-- Annotation Set</span><span>
</span><a name="line-75"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">-- | An 'AnnotationSet' contains all the type/field/variable 'Annotation's</span><span>
</span><a name="line-78"></a><span class="hs-comment">-- , with each group in order, associated with an entity.</span><span>
</span><a name="line-79"></a><span class="hs-comment">-- Note that in its rendering/show instances the unnecessary annotations will be</span><span>
</span><a name="line-80"></a><span class="hs-comment">-- omitted, as well as in some of the functions operating with it.</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- Necessary 'Annotation's are the ones strictly required for a consistent</span><span>
</span><a name="line-82"></a><span class="hs-comment">-- representation.</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- In particular, for each group (t/f/v):</span><span>
</span><a name="line-84"></a><span class="hs-comment">--   - if all annotations are 'noAnn' they are all omitted</span><span>
</span><a name="line-85"></a><span class="hs-comment">--   - if one or more 'noAnn' follow a non-empty 'ann', they are omitted</span><span>
</span><a name="line-86"></a><span class="hs-comment">--   - if one or more 'noAnn' precede a non-empty 'ann', they are kept</span><span>
</span><a name="line-87"></a><span class="hs-comment">--   - every non-empty 'ann' is obviously kept</span><span>
</span><a name="line-88"></a><span class="hs-comment">-- This is why order for each group is important as well as separation of</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- different groups of 'Annotation's.</span><span>
</span><a name="line-90"></a><span class="hs-keyword">data</span><span> </span><a name="AnnotationSet"><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier">AnnotationSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="AnnotationSet"><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier">AnnotationSet</span></a></a><span>
</span><a name="line-91"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="asTypes"><a href="Michelson.Untyped.Annotation.html#asTypes"><span class="hs-identifier">asTypes</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Michelson.Untyped.Annotation.html#TypeAnn"><span class="hs-identifier hs-type">TypeAnn</span></a><span class="hs-special">]</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="asFields"><a href="Michelson.Untyped.Annotation.html#asFields"><span class="hs-identifier">asFields</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Michelson.Untyped.Annotation.html#FieldAnn"><span class="hs-identifier hs-type">FieldAnn</span></a><span class="hs-special">]</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="asVars"><a href="Michelson.Untyped.Annotation.html#asVars"><span class="hs-identifier">asVars</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Michelson.Untyped.Annotation.html#VarAnn"><span class="hs-identifier hs-type">VarAnn</span></a><span class="hs-special">]</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Eq</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Semigroup</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-97"></a><span>  </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-var">AnnotationSet</span></a><span> </span><a name="local-6989586621679159839"><a href="#local-6989586621679159839"><span class="hs-identifier">ts1</span></a></a><span> </span><a name="local-6989586621679159840"><a href="#local-6989586621679159840"><span class="hs-identifier">fs1</span></a></a><span> </span><a name="local-6989586621679159841"><a href="#local-6989586621679159841"><span class="hs-identifier">vs1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-3458764513820541482"><span class="hs-operator">&lt;&gt;</span></a><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-var">AnnotationSet</span></a><span> </span><a name="local-6989586621679159842"><a href="#local-6989586621679159842"><span class="hs-identifier">ts2</span></a></a><span> </span><a name="local-6989586621679159843"><a href="#local-6989586621679159843"><span class="hs-identifier">fs2</span></a></a><span> </span><a name="local-6989586621679159844"><a href="#local-6989586621679159844"><span class="hs-identifier">vs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-var">AnnotationSet</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><a name="line-98"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-99"></a><span>      </span><a name="local-6989586621679159845"><a href="#local-6989586621679159845"><span class="hs-identifier">asTypes</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679159839"><span class="hs-identifier hs-var">ts1</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679159842"><span class="hs-identifier hs-var">ts2</span></a><span>
</span><a name="line-100"></a><span>      </span><a name="local-6989586621679159846"><a href="#local-6989586621679159846"><span class="hs-identifier">asFields</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679159840"><span class="hs-identifier hs-var">fs1</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679159843"><span class="hs-identifier hs-var">fs2</span></a><span>
</span><a name="line-101"></a><span>      </span><a name="local-6989586621679159847"><a href="#local-6989586621679159847"><span class="hs-identifier">asVars</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679159841"><span class="hs-identifier hs-var">vs1</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679159844"><span class="hs-identifier hs-var">vs2</span></a><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-104"></a><span>  </span><a name="local-3458764513820541483"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#emptyAnnSet"><span class="hs-identifier hs-var">emptyAnnSet</span></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- | An 'AnnotationSet' without any 'Annotation'.</span><span>
</span><a name="line-107"></a><span class="hs-identifier">emptyAnnSet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span>
</span><a name="line-108"></a><a name="emptyAnnSet"><a href="Michelson.Untyped.Annotation.html#emptyAnnSet"><span class="hs-identifier">emptyAnnSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-var">AnnotationSet</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-comment">-- | An 'AnnotationSet' with only a single 'Annotation' (of any kind).</span><span>
</span><a name="line-111"></a><span class="hs-identifier">singleAnnSet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679159862"><a href="#local-6989586621679159862"><span class="hs-identifier">tag</span></a></a><span class="hs-operator">.</span><span> </span><a href="Michelson.Untyped.Annotation.html#KnownAnnTag"><span class="hs-identifier hs-type">KnownAnnTag</span></a><span> </span><a href="#local-6989586621679159862"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159862"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span>
</span><a name="line-112"></a><a name="singleAnnSet"><a href="Michelson.Untyped.Annotation.html#singleAnnSet"><span class="hs-identifier">singleAnnSet</span></a></a><span> </span><a name="local-6989586621679159865"><a href="#local-6989586621679159865"><span class="hs-identifier">an</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#singleGroupAnnSet"><span class="hs-identifier hs-var">singleGroupAnnSet</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679159865"><span class="hs-identifier hs-var">an</span></a><span class="hs-special">]</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">-- | An 'AnnotationSet' with several 'Annotation's of the same kind.</span><span>
</span><a name="line-115"></a><span class="hs-identifier">singleGroupAnnSet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679159861"><a href="#local-6989586621679159861"><span class="hs-identifier">tag</span></a></a><span class="hs-operator">.</span><span> </span><a href="Michelson.Untyped.Annotation.html#KnownAnnTag"><span class="hs-identifier hs-type">KnownAnnTag</span></a><span> </span><a href="#local-6989586621679159861"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159861"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span>
</span><a name="line-116"></a><a name="singleGroupAnnSet"><a href="Michelson.Untyped.Annotation.html#singleGroupAnnSet"><span class="hs-identifier">singleGroupAnnSet</span></a></a><span> </span><a name="local-6989586621679159866"><a href="#local-6989586621679159866"><span class="hs-identifier">ans</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-var">AnnotationSet</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><a name="line-117"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-118"></a><span>    </span><a name="local-6989586621679159867"><a href="#local-6989586621679159867"><span class="hs-identifier">asTypes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">eqT</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679159861"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">@</span><a href="Michelson.Untyped.Annotation.html#TypeTag"><span class="hs-identifier hs-type">TypeTag</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679159866"><span class="hs-identifier hs-var">ans</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-119"></a><span>    </span><a name="local-6989586621679159868"><a href="#local-6989586621679159868"><span class="hs-identifier">asFields</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">eqT</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679159861"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">@</span><a href="Michelson.Untyped.Annotation.html#FieldTag"><span class="hs-identifier hs-type">FieldTag</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679159866"><span class="hs-identifier hs-var">ans</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-120"></a><span>    </span><a name="local-6989586621679159869"><a href="#local-6989586621679159869"><span class="hs-identifier">asVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">eqT</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679159861"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">@</span><a href="Michelson.Untyped.Annotation.html#VarTag"><span class="hs-identifier hs-type">VarTag</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679159866"><span class="hs-identifier hs-var">ans</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- | An 'AnnotationSet' built from all 3 kinds of 'Annotation'.</span><span>
</span><a name="line-123"></a><span class="hs-identifier">fullAnnSet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Michelson.Untyped.Annotation.html#TypeAnn"><span class="hs-identifier hs-type">TypeAnn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Michelson.Untyped.Annotation.html#FieldAnn"><span class="hs-identifier hs-type">FieldAnn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Michelson.Untyped.Annotation.html#VarAnn"><span class="hs-identifier hs-type">VarAnn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span>
</span><a name="line-124"></a><a name="fullAnnSet"><a href="Michelson.Untyped.Annotation.html#fullAnnSet"><span class="hs-identifier">fullAnnSet</span></a></a><span> </span><a name="local-6989586621679159870"><a href="#local-6989586621679159870"><span class="hs-identifier">asTypes</span></a></a><span> </span><a name="local-6989586621679159871"><a href="#local-6989586621679159871"><span class="hs-identifier">asFields</span></a></a><span> </span><a name="local-6989586621679159872"><a href="#local-6989586621679159872"><span class="hs-identifier">asVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-var">AnnotationSet</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- | Returns 'True' if all 'Annotation's in the Set are unnecessary/empty/'noAnn'.</span><span>
</span><a name="line-127"></a><span class="hs-comment">-- False otherwise.</span><span>
</span><a name="line-128"></a><span class="hs-identifier">isNoAnnSet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-129"></a><a name="isNoAnnSet"><a href="Michelson.Untyped.Annotation.html#isNoAnnSet"><span class="hs-identifier">isNoAnnSet</span></a></a><span> </span><a name="local-6989586621679159873"><a href="#local-6989586621679159873"><span class="hs-identifier">annSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679159874"><span class="hs-identifier hs-var">asTypes</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679159875"><span class="hs-identifier hs-var">asFields</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679159876"><span class="hs-identifier hs-var">asVars</span></a><span>
</span><a name="line-130"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-var">AnnotationSet</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#minimizeAnnSet"><span class="hs-identifier hs-var">minimizeAnnSet</span></a><span> </span><a href="#local-6989586621679159873"><span class="hs-identifier hs-var">annSet</span></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">-- | Returns the amount of 'Annotation's that are necessary for a consistent</span><span>
</span><a name="line-133"></a><span class="hs-comment">-- representation. See 'AnnotationSet'.</span><span>
</span><a name="line-134"></a><span class="hs-identifier">minAnnSetSize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-135"></a><a name="minAnnSetSize"><a href="Michelson.Untyped.Annotation.html#minAnnSetSize"><span class="hs-identifier">minAnnSetSize</span></a></a><span> </span><a name="local-6989586621679159877"><a href="#local-6989586621679159877"><span class="hs-identifier">annSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679159878"><span class="hs-identifier hs-var">asTypes</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679159879"><span class="hs-identifier hs-var">asFields</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679159880"><span class="hs-identifier hs-var">asVars</span></a><span>
</span><a name="line-136"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-var">AnnotationSet</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#minimizeAnnSet"><span class="hs-identifier hs-var">minimizeAnnSet</span></a><span> </span><a href="#local-6989586621679159877"><span class="hs-identifier hs-var">annSet</span></a><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-comment">-- | Removes all unnecessary 'Annotation's. See 'AnnotationSet'.</span><span>
</span><a name="line-139"></a><span class="hs-identifier">minimizeAnnSet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span>
</span><a name="line-140"></a><a name="minimizeAnnSet"><a href="Michelson.Untyped.Annotation.html#minimizeAnnSet"><span class="hs-identifier">minimizeAnnSet</span></a></a><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-var">AnnotationSet</span></a><span> </span><a name="local-6989586621679159881"><a href="#local-6989586621679159881"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-6989586621679159882"><a href="#local-6989586621679159882"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-6989586621679159883"><a href="#local-6989586621679159883"><span class="hs-identifier">vs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-var">AnnotationSet</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><a name="line-141"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-142"></a><span>    </span><a name="local-6989586621679159884"><a href="#local-6989586621679159884"><span class="hs-identifier">asTypes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#trimEndNoAnn"><span class="hs-identifier hs-var">trimEndNoAnn</span></a><span> </span><a href="#local-6989586621679159881"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-143"></a><span>    </span><a name="local-6989586621679159885"><a href="#local-6989586621679159885"><span class="hs-identifier">asFields</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#trimEndNoAnn"><span class="hs-identifier hs-var">trimEndNoAnn</span></a><span> </span><a href="#local-6989586621679159882"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-144"></a><span>    </span><a name="local-6989586621679159886"><a href="#local-6989586621679159886"><span class="hs-identifier">asVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#trimEndNoAnn"><span class="hs-identifier hs-var">trimEndNoAnn</span></a><span> </span><a href="#local-6989586621679159883"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">-- | Removes all unnecessary 'Annotation's from a list of the same type</span><span>
</span><a name="line-147"></a><span class="hs-identifier">trimEndNoAnn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159860"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159860"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">]</span><span>
</span><a name="line-148"></a><a name="trimEndNoAnn"><a href="Michelson.Untyped.Annotation.html#trimEndNoAnn"><span class="hs-identifier">trimEndNoAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679159887"><a href="#local-6989586621679159887"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679159888"><a href="#local-6989586621679159888"><span class="hs-identifier">lst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679159888"><span class="hs-identifier hs-var">lst</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679159887"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Michelson.Untyped.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679159887"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679159888"><span class="hs-identifier hs-var">lst</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- Rendering</span><span>
</span><a name="line-152"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679159829"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind.Type</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="KnownAnnTag"><a href="Michelson.Untyped.Annotation.html#KnownAnnTag"><span class="hs-identifier">KnownAnnTag</span></a></a><span> </span><a name="local-6989586621679159829"><a href="#local-6989586621679159829"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-155"></a><span>  </span><a name="annPrefix"><a href="Michelson.Untyped.Annotation.html#annPrefix"><span class="hs-identifier">annPrefix</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-keyword">instance</span><span> </span><a href="Michelson.Untyped.Annotation.html#KnownAnnTag"><span class="hs-identifier hs-type">KnownAnnTag</span></a><span> </span><a href="#local-6989586621679159838"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159838"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-158"></a><span>  </span><a name="local-8214565720323784705"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Printer.Util.html#printDocS"><span class="hs-identifier hs-var">printDocS</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Michelson.Printer.Util.html#renderDoc"><span class="hs-identifier hs-var">renderDoc</span></a><span> </span><a href="Michelson.Printer.Util.html#doesntNeedParens"><span class="hs-identifier hs-var">doesntNeedParens</span></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-keyword">data</span><span> </span><a name="TypeTag"><a href="Michelson.Untyped.Annotation.html#TypeTag"><span class="hs-identifier">TypeTag</span></a></a><span>
</span><a name="line-161"></a><span class="hs-keyword">data</span><span> </span><a name="FieldTag"><a href="Michelson.Untyped.Annotation.html#FieldTag"><span class="hs-identifier">FieldTag</span></a></a><span>
</span><a name="line-162"></a><span class="hs-keyword">data</span><span> </span><a name="VarTag"><a href="Michelson.Untyped.Annotation.html#VarTag"><span class="hs-identifier">VarTag</span></a></a><span>
</span><a name="line-163"></a><span class="hs-keyword">data</span><span> </span><a name="SomeTag"><a href="Michelson.Untyped.Annotation.html#SomeTag"><span class="hs-identifier">SomeTag</span></a></a><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-keyword">type</span><span> </span><a name="TypeAnn"><a href="Michelson.Untyped.Annotation.html#TypeAnn"><span class="hs-identifier">TypeAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="Michelson.Untyped.Annotation.html#TypeTag"><span class="hs-identifier hs-type">TypeTag</span></a><span>
</span><a name="line-166"></a><span class="hs-keyword">type</span><span> </span><a name="FieldAnn"><a href="Michelson.Untyped.Annotation.html#FieldAnn"><span class="hs-identifier">FieldAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="Michelson.Untyped.Annotation.html#FieldTag"><span class="hs-identifier hs-type">FieldTag</span></a><span>
</span><a name="line-167"></a><span class="hs-keyword">type</span><span> </span><a name="VarAnn"><a href="Michelson.Untyped.Annotation.html#VarAnn"><span class="hs-identifier">VarAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="Michelson.Untyped.Annotation.html#VarTag"><span class="hs-identifier hs-type">VarTag</span></a><span>
</span><a name="line-168"></a><span class="hs-keyword">type</span><span> </span><a name="SomeAnn"><a href="Michelson.Untyped.Annotation.html#SomeAnn"><span class="hs-identifier">SomeAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="Michelson.Untyped.Annotation.html#SomeTag"><span class="hs-identifier hs-type">SomeTag</span></a><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-keyword">instance</span><span> </span><a href="Michelson.Untyped.Annotation.html#KnownAnnTag"><span class="hs-identifier hs-type">KnownAnnTag</span></a><span> </span><a href="Michelson.Untyped.Annotation.html#FieldTag"><span class="hs-identifier hs-type">FieldTag</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-171"></a><span>  </span><a name="local-8214565720323934708"><a href="Michelson.Untyped.Annotation.html#annPrefix"><span class="hs-identifier">annPrefix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;%&quot;</span><span>
</span><a name="line-172"></a><span class="hs-keyword">instance</span><span> </span><a href="Michelson.Untyped.Annotation.html#KnownAnnTag"><span class="hs-identifier hs-type">KnownAnnTag</span></a><span> </span><a href="Michelson.Untyped.Annotation.html#VarTag"><span class="hs-identifier hs-type">VarTag</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-173"></a><span>  </span><a name="local-8214565720323934708"><a href="Michelson.Untyped.Annotation.html#annPrefix"><span class="hs-identifier">annPrefix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;@&quot;</span><span>
</span><a name="line-174"></a><span class="hs-keyword">instance</span><span> </span><a href="Michelson.Untyped.Annotation.html#KnownAnnTag"><span class="hs-identifier hs-type">KnownAnnTag</span></a><span> </span><a href="Michelson.Untyped.Annotation.html#TypeTag"><span class="hs-identifier hs-type">TypeTag</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-175"></a><span>  </span><a name="local-8214565720323934708"><a href="Michelson.Untyped.Annotation.html#annPrefix"><span class="hs-identifier">annPrefix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;:&quot;</span><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-keyword">instance</span><span> </span><a href="Michelson.Untyped.Annotation.html#KnownAnnTag"><span class="hs-identifier hs-type">KnownAnnTag</span></a><span> </span><a href="#local-6989586621679159837"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Michelson.Printer.Util.html#RenderDoc"><span class="hs-identifier hs-type">RenderDoc</span></a><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159837"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-178"></a><span>  </span><a name="local-8214565720323918072"><a href="Michelson.Printer.Util.html#renderDoc"><span class="hs-identifier">renderDoc</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#renderAnn"><span class="hs-identifier hs-var">renderAnn</span></a><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-keyword">instance</span><span> </span><a href="Michelson.Untyped.Annotation.html#KnownAnnTag"><span class="hs-identifier hs-type">KnownAnnTag</span></a><span> </span><a href="#local-6989586621679159836"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159836"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-181"></a><span>  </span><a name="local-8214565720323801212"><span class="hs-identifier">build</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Printer.Util.html#buildRenderDoc"><span class="hs-identifier hs-var">buildRenderDoc</span></a><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-184"></a><span>  </span><a name="local-8214565720323784705"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Printer.Util.html#printDocS"><span class="hs-identifier hs-var">printDocS</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Michelson.Printer.Util.html#renderDoc"><span class="hs-identifier hs-var">renderDoc</span></a><span> </span><a href="Michelson.Printer.Util.html#doesntNeedParens"><span class="hs-identifier hs-var">doesntNeedParens</span></a><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-keyword">instance</span><span> </span><a href="Michelson.Printer.Util.html#RenderDoc"><span class="hs-identifier hs-type">RenderDoc</span></a><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-187"></a><span>  </span><a name="local-8214565720323918072"><a href="Michelson.Printer.Util.html#renderDoc"><span class="hs-identifier">renderDoc</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-var">AnnotationSet</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-188"></a><span>    </span><a href="Michelson.Untyped.Annotation.html#renderAnnGroup"><span class="hs-identifier hs-var">renderAnnGroup</span></a><span> </span><a href="#local-6989586621679159833"><span class="hs-identifier hs-var">asTypes</span></a><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#renderAnnGroup"><span class="hs-identifier hs-var">renderAnnGroup</span></a><span> </span><a href="#local-6989586621679159834"><span class="hs-identifier hs-var">asFields</span></a><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#renderAnnGroup"><span class="hs-identifier hs-var">renderAnnGroup</span></a><span> </span><a href="#local-6989586621679159835"><span class="hs-identifier hs-var">asVars</span></a><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationSet"><span class="hs-identifier hs-type">AnnotationSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-191"></a><span>  </span><a name="local-8214565720323801212"><span class="hs-identifier">build</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Printer.Util.html#buildRenderDoc"><span class="hs-identifier hs-var">buildRenderDoc</span></a><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-comment">-- | Renders a single 'Annotation', this is used in every rendering instance of it.</span><span>
</span><a name="line-194"></a><span class="hs-comment">-- Note that this also renders empty ones/'noAnn's because a single 'Annotation'</span><span>
</span><a name="line-195"></a><span class="hs-comment">-- does not have enough context to know if it can be omitted, use 'singleAnnSet'</span><span>
</span><a name="line-196"></a><span class="hs-comment">-- if you want to hide it instead.</span><span>
</span><a name="line-197"></a><span class="hs-identifier">renderAnn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679159859"><a href="#local-6989586621679159859"><span class="hs-identifier">tag</span></a></a><span class="hs-operator">.</span><span> </span><a href="Michelson.Untyped.Annotation.html#KnownAnnTag"><span class="hs-identifier hs-type">KnownAnnTag</span></a><span> </span><a href="#local-6989586621679159859"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159859"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Doc</span><span>
</span><a name="line-198"></a><a name="renderAnn"><a href="Michelson.Untyped.Annotation.html#renderAnn"><span class="hs-identifier">renderAnn</span></a></a><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-var">Annotation</span></a><span> </span><a name="local-6989586621679159889"><a href="#local-6989586621679159889"><span class="hs-identifier">text</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">textStrict</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Michelson.Untyped.Annotation.html#annPrefix"><span class="hs-identifier hs-var">annPrefix</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679159859"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679159889"><span class="hs-identifier hs-var">text</span></a><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span class="hs-comment">-- | Renders a list of 'Annotation's, omitting unnecessary empty ones/'noAnn'.</span><span>
</span><a name="line-201"></a><span class="hs-comment">-- This is used (3 times) to render an 'AnnotationSet'.</span><span>
</span><a name="line-202"></a><span class="hs-identifier">renderAnnGroup</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Michelson.Untyped.Annotation.html#KnownAnnTag"><span class="hs-identifier hs-type">KnownAnnTag</span></a><span> </span><a href="#local-6989586621679159858"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159858"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Doc</span><span>
</span><a name="line-203"></a><a name="renderAnnGroup"><a href="Michelson.Untyped.Annotation.html#renderAnnGroup"><span class="hs-identifier">renderAnnGroup</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hsep</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Michelson.Untyped.Annotation.html#renderAnn"><span class="hs-identifier hs-var">renderAnn</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Michelson.Untyped.Annotation.html#trimEndNoAnn"><span class="hs-identifier hs-var">trimEndNoAnn</span></a><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-206"></a><span class="hs-comment">-- Creation and conversions</span><span>
</span><a name="line-207"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-identifier">noAnn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159857"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-210"></a><a name="noAnn"><a href="Michelson.Untyped.Annotation.html#noAnn"><span class="hs-identifier">noAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationUnsafe"><span class="hs-identifier hs-var">AnnotationUnsafe</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-comment">-- | Makes an `Annotation` from its textual value, prefix (%/@/:) excluded</span><span>
</span><a name="line-213"></a><span class="hs-comment">-- Throws an error if the given `Text` contains invalid characters</span><span>
</span><a name="line-214"></a><span class="hs-identifier">ann</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HasCallStack</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159856"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-215"></a><a name="ann"><a href="Michelson.Untyped.Annotation.html#ann"><span class="hs-identifier">ann</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Michelson.Untyped.Annotation.html#mkAnnotation"><span class="hs-identifier hs-var">mkAnnotation</span></a><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-comment">-- | Makes an `Annotation` from its textual value, prefix (%/@/:) excluded</span><span>
</span><a name="line-218"></a><span class="hs-comment">-- Returns a `Text` error message if the given `Text` contains invalid characters</span><span>
</span><a name="line-219"></a><span class="hs-identifier">mkAnnotation</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159855"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-220"></a><a name="mkAnnotation"><a href="Michelson.Untyped.Annotation.html#mkAnnotation"><span class="hs-identifier">mkAnnotation</span></a></a><span> </span><a name="local-6989586621679159902"><a href="#local-6989586621679159902"><span class="hs-identifier">text</span></a></a><span>
</span><a name="line-221"></a><span>  </span><span class="hs-comment">-- TODO [#48] these are special annotations and should not be always allowed</span><span>
</span><a name="line-222"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679159902"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="Michelson.Untyped.Annotation.html#specialVarAnns"><span class="hs-identifier hs-var">specialVarAnns</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationUnsafe"><span class="hs-identifier hs-var">AnnotationUnsafe</span></a><span> </span><a href="#local-6989586621679159902"><span class="hs-identifier hs-var">text</span></a><span>
</span><a name="line-223"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679159902"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Michelson.Untyped.Annotation.html#specialFieldAnn"><span class="hs-identifier hs-var">specialFieldAnn</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationUnsafe"><span class="hs-identifier hs-var">AnnotationUnsafe</span></a><span> </span><a href="#local-6989586621679159902"><span class="hs-identifier hs-var">text</span></a><span>
</span><a name="line-224"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-225"></a><span>    </span><a name="local-6989586621679159906"><a href="#local-6989586621679159906"><span class="hs-identifier">suffix</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">T.uncons</span><span> </span><a href="#local-6989586621679159902"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-226"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679159903"><a href="#local-6989586621679159903"><span class="hs-identifier">h</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679159904"><a href="#local-6989586621679159904"><span class="hs-identifier">tl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Michelson.Untyped.Annotation.html#isValidAnnStart"><span class="hs-identifier hs-var">isValidAnnStart</span></a><span> </span><a href="#local-6989586621679159903"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679159904"><span class="hs-identifier hs-var">tl</span></a><span>
</span><a name="line-227"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679159905"><a href="#local-6989586621679159905"><span class="hs-identifier">h</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.snoc</span><span> </span><span class="hs-string">&quot;Invalid first character: &quot;</span><span> </span><a href="#local-6989586621679159905"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-228"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-229"></a><span>    </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Michelson.Untyped.Annotation.html#AnnotationUnsafe"><span class="hs-identifier hs-var">AnnotationUnsafe</span></a><span> </span><a href="#local-6989586621679159902"><span class="hs-identifier hs-var">text</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">T.snoc</span><span> </span><span class="hs-string">&quot;Invalid character: &quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-230"></a><span>      </span><span class="hs-identifier hs-var">T.find</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Michelson.Untyped.Annotation.html#isValidAnnBodyChar"><span class="hs-identifier hs-var">isValidAnnBodyChar</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679159906"><span class="hs-identifier hs-var">suffix</span></a><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-comment">-- | List of all the special Variable Annotations, only allowed in `CAR` and `CDR`</span><span>
</span><a name="line-233"></a><span class="hs-comment">-- instructions, prefix (@) excluded.</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- These do not respect the rules of `isValidAnnStart` and `isValidAnnBodyChar`.</span><span>
</span><a name="line-235"></a><span class="hs-identifier">specialVarAnns</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-236"></a><a name="specialVarAnns"><a href="Michelson.Untyped.Annotation.html#specialVarAnns"><span class="hs-identifier">specialVarAnns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;%%&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;%&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-comment">-- | The only special Field Annotation, only allowed in `PAIR`, `LEFT` and</span><span>
</span><a name="line-239"></a><span class="hs-comment">-- `RIGHT` instructions, prefix (%) excluded.</span><span>
</span><a name="line-240"></a><span class="hs-comment">-- This does not respect the rules of `isValidAnnStart` and `isValidAnnBodyChar`.</span><span>
</span><a name="line-241"></a><span class="hs-identifier">specialFieldAnn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-242"></a><a name="specialFieldAnn"><a href="Michelson.Untyped.Annotation.html#specialFieldAnn"><span class="hs-identifier">specialFieldAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;@&quot;</span><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-comment">-- | Checks if a `Char` is valid to be the first of an annotation, prefix</span><span>
</span><a name="line-246"></a><span class="hs-comment">-- (%/@/:) excluded, the ones following should be checked with</span><span>
</span><a name="line-247"></a><span class="hs-comment">-- `isValidAnnBodyChar` instead.</span><span>
</span><a name="line-248"></a><span class="hs-comment">-- Note that this does not check Special Annotations, see `specialVarAnns`</span><span>
</span><a name="line-249"></a><span class="hs-comment">-- and `specialFieldAnn`</span><span>
</span><a name="line-250"></a><span class="hs-identifier">isValidAnnStart</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-251"></a><a name="isValidAnnStart"><a href="Michelson.Untyped.Annotation.html#isValidAnnStart"><span class="hs-identifier">isValidAnnStart</span></a></a><span> </span><a name="local-6989586621679159907"><a href="#local-6989586621679159907"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isAscii</span><span> </span><a href="#local-6989586621679159907"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">isAlpha</span><span> </span><a href="#local-6989586621679159907"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679159907"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'_'</span><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-comment">-- | Checks if a `Char` is valid to be part of an annotation, following a valid</span><span>
</span><a name="line-254"></a><span class="hs-comment">-- first character (see `isValidAnnStart`) and the prefix (%/@/:).</span><span>
</span><a name="line-255"></a><span class="hs-comment">-- Note that this does not check Special Annotations, see `specialVarAnns`</span><span>
</span><a name="line-256"></a><span class="hs-comment">-- and `specialFieldAnn`</span><span>
</span><a name="line-257"></a><span class="hs-identifier">isValidAnnBodyChar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-258"></a><a name="isValidAnnBodyChar"><a href="Michelson.Untyped.Annotation.html#isValidAnnBodyChar"><span class="hs-identifier">isValidAnnBodyChar</span></a></a><span> </span><a name="local-6989586621679160245"><a href="#local-6989586621679160245"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-259"></a><span>  </span><a href="Michelson.Untyped.Annotation.html#isValidAnnStart"><span class="hs-identifier hs-var">isValidAnnStart</span></a><span> </span><a href="#local-6989586621679160245"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isAscii</span><span> </span><a href="#local-6989586621679160245"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">isNumber</span><span> </span><a href="#local-6989586621679160245"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span>  </span><a href="#local-6989586621679160245"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;.%@&quot;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Semigroup</span><span> </span><a href="Michelson.Untyped.Annotation.html#VarAnn"><span class="hs-identifier hs-type">VarAnn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-262"></a><span>  </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-var">Annotation</span></a><span> </span><a name="local-6989586621679159831"><a href="#local-6989586621679159831"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-3458764513820541482"><span class="hs-operator">&lt;&gt;</span></a><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-var">Annotation</span></a><span> </span><a name="local-6989586621679159832"><a href="#local-6989586621679159832"><span class="hs-identifier">b</span></a></a><span>
</span><a name="line-263"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679159831"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679159832"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#ann"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679159831"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679159832"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-264"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#ann"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679159831"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679159832"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-265"></a><span>
</span><a name="line-266"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="Michelson.Untyped.Annotation.html#VarAnn"><span class="hs-identifier hs-type">VarAnn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-267"></a><span>    </span><a name="local-3458764513820541483"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-identifier">unifyAnn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159854"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159854"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159854"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-270"></a><a name="unifyAnn"><a href="Michelson.Untyped.Annotation.html#unifyAnn"><span class="hs-identifier">unifyAnn</span></a></a><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-var">Annotation</span></a><span> </span><a name="local-6989586621679160246"><a href="#local-6989586621679160246"><span class="hs-identifier">ann1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-var">Annotation</span></a><span> </span><a name="local-6989586621679160247"><a href="#local-6989586621679160247"><span class="hs-identifier">ann2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679160246"><span class="hs-identifier hs-var">ann1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679160247"><span class="hs-identifier hs-var">ann2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Michelson.Untyped.Annotation.html#ann"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679160246"><span class="hs-identifier hs-var">ann1</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679160247"><span class="hs-identifier hs-var">ann2</span></a><span>
</span><a name="line-272"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679160246"><span class="hs-identifier hs-var">ann1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679160247"><span class="hs-identifier hs-var">ann2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Michelson.Untyped.Annotation.html#ann"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621679160246"><span class="hs-identifier hs-var">ann1</span></a><span>
</span><a name="line-273"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-identifier">ifAnnUnified</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159853"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159853"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-276"></a><a name="ifAnnUnified"><a href="Michelson.Untyped.Annotation.html#ifAnnUnified"><span class="hs-identifier">ifAnnUnified</span></a></a><span> </span><a name="local-6989586621679160248"><a href="#local-6989586621679160248"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679160249"><a href="#local-6989586621679160249"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679160248"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-special">`</span><a href="Michelson.Untyped.Annotation.html#unifyAnn"><span class="hs-identifier hs-var">unifyAnn</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679160249"><span class="hs-identifier hs-var">a2</span></a><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><span class="hs-identifier">disjoinVn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Michelson.Untyped.Annotation.html#VarAnn"><span class="hs-identifier hs-type">VarAnn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#VarAnn"><span class="hs-identifier hs-type">VarAnn</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#VarAnn"><span class="hs-identifier hs-type">VarAnn</span></a><span class="hs-special">)</span><span>
</span><a name="line-279"></a><a name="disjoinVn"><a href="Michelson.Untyped.Annotation.html#disjoinVn"><span class="hs-identifier">disjoinVn</span></a></a><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-var">Annotation</span></a><span> </span><a name="local-6989586621679160250"><a href="#local-6989586621679160250"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">T.findIndex</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'.'</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.reverse</span><span> </span><a href="#local-6989586621679160250"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-280"></a><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679160251"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679160252"><a href="#local-6989586621679160252"><span class="hs-identifier">pos</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#ann"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><a href="#local-6989586621679160252"><span class="hs-identifier hs-var">pos</span></a><span> </span><a href="#local-6989586621679160250"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#ann"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.drop</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679160252"><span class="hs-identifier hs-var">pos</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679160250"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-281"></a><span>  </span><span class="hs-identifier hs-var">Nothing</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a><span class="hs-special">,</span><span> </span><a href="Michelson.Untyped.Annotation.html#ann"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621679160250"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-282"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-283"></a><span>    </span><a name="local-6989586621679160251"><a href="#local-6989586621679160251"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.length</span><span> </span><a href="#local-6989586621679160250"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span class="hs-identifier">convAnn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159851"><span class="hs-identifier hs-type">tag1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159852"><span class="hs-identifier hs-type">tag2</span></a><span>
</span><a name="line-286"></a><a name="convAnn"><a href="Michelson.Untyped.Annotation.html#convAnn"><span class="hs-identifier">convAnn</span></a></a><span> </span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-var">Annotation</span></a><span> </span><a name="local-6989586621679160253"><a href="#local-6989586621679160253"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Michelson.Untyped.Annotation.html#ann"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621679160253"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-keyword">pattern</span><span> </span><span class="hs-identifier">WithAnn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159850"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span> </span><a href="#local-6989586621679159850"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-289"></a><span class="hs-keyword">pattern</span><span> </span><a name="WithAnn"><a href="Michelson.Untyped.Annotation.html#WithAnn"><span class="hs-identifier">WithAnn</span></a></a><span> </span><a href="#local-6989586621679160254"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a name="local-6989586621679160254"><a href="#local-6989586621679160254"><span class="hs-identifier">ann</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Michelson.Untyped.Annotation.html#Annotation"><span class="hs-identifier hs-var">Annotation</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><a href="#local-6989586621679163743"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679163743"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679163743"><span class="hs-identifier hs-var">Annotation</span></a><span>
</span><a name="line-292"></a><a href="#local-6989586621679163876"><span class="hs-identifier hs-var">deriveLift</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679163876"><span class="hs-identifier hs-var">Annotation</span></a><span>
</span><a name="line-293"></a></pre></body></html>