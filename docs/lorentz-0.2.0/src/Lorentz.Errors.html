<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TypeFamilyDependencies #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">-- We want to make sure 'failUsingArg' is used with sane argument.</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints #-}</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Lorentz.Errors</span><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- * Haskell to 'Value' conversion</span><span>
</span><a name="line-8"></a><span>    </span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#isoErrorToVal"><span class="hs-identifier hs-var">isoErrorToVal</span></a><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#isoErrorFromVal"><span class="hs-identifier hs-var">isoErrorFromVal</span></a><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier hs-type">ErrorHasDoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#typeDocMdDescriptionReferToError"><span class="hs-identifier hs-var">typeDocMdDescriptionReferToError</span></a><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#customErrorDocHaskellRepGeneral"><span class="hs-identifier hs-var">customErrorDocHaskellRepGeneral</span></a><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#UnspecifiedError"><span class="hs-identifier hs-type">UnspecifiedError</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span>    </span><span class="hs-comment">-- * General instructions</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#failUsing"><span class="hs-identifier hs-var">failUsing</span></a><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#failUnexpected"><span class="hs-identifier hs-var">failUnexpected</span></a><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span>    </span><span class="hs-comment">-- * Custom errors</span><span>
</span><a name="line-22"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span>
</span><a name="line-23"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#failCustom"><span class="hs-identifier hs-var">failCustom</span></a><span>
</span><a name="line-25"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#RequireNoArgError"><span class="hs-identifier hs-type">RequireNoArgError</span></a><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#failCustom_"><span class="hs-identifier hs-var">failCustom_</span></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span>    </span><span class="hs-comment">-- * Documentation</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#ErrorClass"><span class="hs-identifier hs-type">ErrorClass</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#CustomErrorHasDoc"><span class="hs-identifier hs-type">CustomErrorHasDoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-type">DError</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier hs-type">DThrows</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span>    </span><span class="hs-comment">-- * Old interface (DEPRECATED)</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#customErrorToVal"><span class="hs-identifier hs-var">customErrorToVal</span></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#customErrorFromVal"><span class="hs-identifier hs-var">customErrorFromVal</span></a><span>
</span><a name="line-37"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#failUsingArg"><span class="hs-identifier hs-var">failUsingArg</span></a><span>
</span><a name="line-38"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#FailUsingArg"><span class="hs-identifier hs-type">FailUsingArg</span></a><span>
</span><a name="line-39"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#CustomErrorNoIsoValue"><span class="hs-identifier hs-type">CustomErrorNoIsoValue</span></a><span>
</span><a name="line-40"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#deriveCustomError"><span class="hs-identifier hs-var">deriveCustomError</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>    </span><span class="hs-comment">-- * Internals</span><span>
</span><a name="line-43"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#errorTagToText"><span class="hs-identifier hs-var">errorTagToText</span></a><span>
</span><a name="line-44"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#errorTagToMText"><span class="hs-identifier hs-var">errorTagToMText</span></a><span>
</span><a name="line-45"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Char</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">C</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Constraint</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Dict</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Kind</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Kind</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Singletons</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SingI</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">demote</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Type.Equality</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-type">==</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Typeable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cast</span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Fmt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Buildable</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">build</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fmt</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pretty</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+|</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+||</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">|+</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">||+</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.TypeLits</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ErrorMessage</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">KnownSymbol</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">symbolVal</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Language.Haskell.TH</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TH</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Text.Show</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="Lorentz.Base.html"><span class="hs-identifier">Lorentz.Base</span></a><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="Lorentz.Doc.html"><span class="hs-identifier">Lorentz.Doc</span></a><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><a href="Lorentz.Instr.html"><span class="hs-identifier">Lorentz.Instr</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Instr.html#cast"><span class="hs-identifier hs-var">cast</span></a><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="Lorentz.Value.html"><span class="hs-identifier">Lorentz.Value</span></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Michelson.Text</span><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Michelson.Typed.Haskell</span><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Michelson.Typed.Instr</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Michelson.Typed.Scope</span><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Michelson.Typed.Sing</span><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Michelson.Typed.T</span><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Michelson.Typed.Value</span><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util.Label</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Label</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util.Markdown</span><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util.Type</span><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util.Typeable</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util.TypeLits</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-77"></a><span class="hs-comment">-- IsError</span><span>
</span><a name="line-78"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-keyword">type</span><span> </span><a name="ErrorScope"><a href="Lorentz.Errors.html#ErrorScope"><span class="hs-identifier">ErrorScope</span></a></a><span> </span><a name="local-6989586621679426001"><a href="#local-6989586621679426001"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-81"></a><span>  </span><span class="hs-comment">-- We can require a weaker constraint (e.g. no 'HasNoOp'), but</span><span>
</span><a name="line-82"></a><span>  </span><span class="hs-comment">-- for now it's the simplest way to make 'failUsing' work</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679426001"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-84"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ConstantScope</span><span> </span><a href="#local-6989586621679426001"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-85"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-keyword">type</span><span> </span><a name="KnownError"><a href="Lorentz.Errors.html#KnownError"><span class="hs-identifier">KnownError</span></a></a><span> </span><a name="local-6989586621679426000"><a href="#local-6989586621679426000"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#ErrorScope"><span class="hs-identifier hs-type">ErrorScope</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToT</span><span> </span><a href="#local-6989586621679426000"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">-- | Haskell type representing error.</span><span>
</span><a name="line-90"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679425996"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier hs-type">ErrorHasDoc</span></a><span> </span><a href="#local-6989586621679425996"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="IsError"><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier">IsError</span></a></a><span> </span><a name="local-6989586621679425996"><a href="#local-6989586621679425996"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span>  </span><span class="hs-comment">-- | Converts a Haskell error into @Value@ representation.</span><span>
</span><a name="line-93"></a><span>  </span><a name="errorToVal"><a href="Lorentz.Errors.html#errorToVal"><span class="hs-identifier">errorToVal</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679425996"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679425998"><a href="#local-6989586621679425998"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><a href="Lorentz.Errors.html#ErrorScope"><span class="hs-identifier hs-type">ErrorScope</span></a><span> </span><a href="#local-6989586621679425998"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Value</span><span> </span><a href="#local-6989586621679425998"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679425997"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679425997"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span>  </span><span class="hs-comment">-- | Converts a @Value@ into Haskell error.</span><span>
</span><a name="line-96"></a><span>  </span><a name="errorFromVal"><a href="Lorentz.Errors.html#errorFromVal"><span class="hs-identifier">errorFromVal</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679425999"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SingI</span><span> </span><a href="#local-6989586621679425999"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Value</span><span> </span><a href="#local-6989586621679425999"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><a href="#local-6989586621679425996"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- | Implementation of 'errorToVal' via 'IsoValue'.</span><span>
</span><a name="line-99"></a><span class="hs-identifier">isoErrorToVal</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#KnownError"><span class="hs-identifier hs-type">KnownError</span></a><span> </span><a href="#local-6989586621679426400"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">IsoValue</span><span> </span><a href="#local-6989586621679426400"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679426400"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679426402"><a href="#local-6989586621679426402"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><a href="Lorentz.Errors.html#ErrorScope"><span class="hs-identifier hs-type">ErrorScope</span></a><span> </span><a href="#local-6989586621679426402"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Value</span><span> </span><a href="#local-6989586621679426402"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679426401"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679426401"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-102"></a><a name="isoErrorToVal"><a href="Lorentz.Errors.html#isoErrorToVal"><span class="hs-identifier">isoErrorToVal</span></a></a><span> </span><a name="local-6989586621679426403"><a href="#local-6989586621679426403"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679426404"><a href="#local-6989586621679426404"><span class="hs-identifier">cont</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679426404"><span class="hs-identifier hs-var">cont</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toVal</span><span> </span><a href="#local-6989586621679426403"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">-- | Implementation of 'errorFromVal' via 'IsoValue'.</span><span>
</span><a name="line-105"></a><span class="hs-identifier">isoErrorFromVal</span><span>
</span><a name="line-106"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679426398"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToT</span><span> </span><a href="#local-6989586621679426399"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">IsoValue</span><span> </span><a href="#local-6989586621679426399"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Value</span><span> </span><a href="#local-6989586621679426398"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><a href="#local-6989586621679426399"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-108"></a><a name="isoErrorFromVal"><a href="Lorentz.Errors.html#isoErrorFromVal"><span class="hs-identifier">isoErrorFromVal</span></a></a><span> </span><a name="local-6989586621679426405"><a href="#local-6989586621679426405"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromVal</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">gcastE</span><span> </span><a href="#local-6989586621679426405"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679425994"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="ErrorHasDoc"><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier">ErrorHasDoc</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679425994"><a href="#local-6989586621679425994"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind.Type</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-comment">-- | Name of error as it appears in the corresponding section title.</span><span>
</span><a name="line-112"></a><span>  </span><a name="errorDocName"><a href="Lorentz.Errors.html#errorDocName"><span class="hs-identifier">errorDocName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span>  </span><span class="hs-comment">-- | What should happen for this error to be raised.</span><span>
</span><a name="line-115"></a><span>  </span><a name="errorDocMdCause"><a href="Lorentz.Errors.html#errorDocMdCause"><span class="hs-identifier">errorDocMdCause</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Markdown</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span>  </span><span class="hs-comment">-- | Brief version of 'errorDocMdCause'.</span><span>
</span><a name="line-118"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-119"></a><span>  </span><span class="hs-comment">-- This will appear along with the error when mentioned in entrypoint description.</span><span>
</span><a name="line-120"></a><span>  </span><span class="hs-comment">-- By default, the first sentence of the full description is used.</span><span>
</span><a name="line-121"></a><span>  </span><a name="errorDocMdCauseInEntrypoint"><a href="Lorentz.Errors.html#errorDocMdCauseInEntrypoint"><span class="hs-identifier">errorDocMdCauseInEntrypoint</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Markdown</span><span>
</span><a name="line-122"></a><span>  </span><a name="local-8214565720324200862"><a href="Lorentz.Errors.html#errorDocMdCauseInEntrypoint"><span class="hs-identifier">errorDocMdCauseInEntrypoint</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#pickFirstSentence"><span class="hs-identifier hs-var">pickFirstSentence</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Lorentz.Errors.html#errorDocMdCause"><span class="hs-identifier hs-var">errorDocMdCause</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679425994"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span>  </span><span class="hs-comment">-- | How this error is represented in Haskell.</span><span>
</span><a name="line-125"></a><span>  </span><a name="errorDocHaskellRep"><a href="Lorentz.Errors.html#errorDocHaskellRep"><span class="hs-identifier">errorDocHaskellRep</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Markdown</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span>  </span><span class="hs-comment">-- | Error class.</span><span>
</span><a name="line-128"></a><span>  </span><a name="errorDocClass"><a href="Lorentz.Errors.html#errorDocClass"><span class="hs-identifier">errorDocClass</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lorentz.Errors.html#ErrorClass"><span class="hs-identifier hs-type">ErrorClass</span></a><span>
</span><a name="line-129"></a><span>  </span><a name="local-8214565720324200864"><a href="Lorentz.Errors.html#errorDocClass"><span class="hs-identifier">errorDocClass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#ErrClassUnknown"><span class="hs-identifier hs-var">ErrClassUnknown</span></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span>  </span><span class="hs-comment">-- | Which definitions documentation for this error mentions.</span><span>
</span><a name="line-132"></a><span>  </span><a name="errorDocDependencies"><a href="Lorentz.Errors.html#errorDocDependencies"><span class="hs-identifier">errorDocDependencies</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">SomeDocDefinitionItem</span><span class="hs-special">]</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span>  </span><span class="hs-comment">-- | Constraints which we require in a particular instance.</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-comment">-- You are not oblidged to often instantiate this correctly, it is only useful</span><span>
</span><a name="line-136"></a><span>  </span><span class="hs-comment">-- for some utilities.</span><span>
</span><a name="line-137"></a><span>  </span><span class="hs-keyword">type</span><span> </span><a name="ErrorRequirements"><a href="Lorentz.Errors.html#ErrorRequirements"><span class="hs-identifier">ErrorRequirements</span></a></a><span> </span><a name="local-6989586621679425994"><a href="#local-6989586621679425994"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span>
</span><a name="line-138"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ErrorRequirements</span><span> </span><a name="local-6989586621679425995"><a href="#local-6989586621679425995"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span>  </span><span class="hs-comment">-- | Captured constraints which we require in a particular instance.</span><span>
</span><a name="line-141"></a><span>  </span><span class="hs-comment">-- This is a way to encode a bidirectional instance in the nowaday Haskell,</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-comment">-- for @class MyConstraint =&gt; ErrorHasDoc MyType@ instance it lets deducing</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-comment">-- @MyConstraint@ by @ErrorHasDoc MyType@.</span><span>
</span><a name="line-144"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-145"></a><span>  </span><span class="hs-comment">-- You are not oblidged to always instantiate, it is only useful for some</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-comment">-- utilities which otherwise would not compile.</span><span>
</span><a name="line-147"></a><span>  </span><a name="errorDocRequirements"><a href="Lorentz.Errors.html#errorDocRequirements"><span class="hs-identifier">errorDocRequirements</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Dict</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorRequirements"><span class="hs-identifier hs-type">ErrorRequirements</span></a><span> </span><a href="#local-6989586621679425994"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>  </span><span class="hs-keyword">default</span><span> </span><a name="errorDocRequirements"><a href="Lorentz.Errors.html#errorDocRequirements"><span class="hs-identifier">errorDocRequirements</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lorentz.Errors.html#ErrorRequirements"><span class="hs-identifier hs-type">ErrorRequirements</span></a><span> </span><a href="#local-6989586621679425994"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Dict</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorRequirements"><span class="hs-identifier hs-type">ErrorRequirements</span></a><span> </span><a href="#local-6989586621679425994"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>  </span><a name="local-8214565720324200866"><a href="Lorentz.Errors.html#errorDocRequirements"><span class="hs-identifier">errorDocRequirements</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Dict</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-comment">-- | Helper for managing descriptions.</span><span>
</span><a name="line-152"></a><span class="hs-identifier">pickFirstSentence</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Markdown</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Markdown</span><span>
</span><a name="line-153"></a><a name="pickFirstSentence"><a href="Lorentz.Errors.html#pickFirstSentence"><span class="hs-identifier">pickFirstSentence</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toText</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679426406"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmt</span><span>
</span><a name="line-154"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-156"></a><span>    </span><a name="local-6989586621679426406"><a href="#local-6989586621679426406"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-157"></a><span>      </span><span class="hs-char">'.'</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679426407"><a href="#local-6989586621679426407"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">C.isSpace</span><span> </span><a href="#local-6989586621679426407"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-158"></a><span>      </span><a name="local-6989586621679426745"><a href="#local-6989586621679426745"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679426746"><a href="#local-6989586621679426746"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679426745"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679426406"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679426746"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-159"></a><span>      </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span class="hs-comment">-- Instances</span><span>
</span><a name="line-162"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">-- | Use this for internal errors only.</span><span>
</span><a name="line-165"></a><span class="hs-comment">--</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- &quot;Normal&quot; error scenarios should use the mechanism of custom errors, see below.</span><span>
</span><a name="line-167"></a><span class="hs-keyword">instance</span><span> </span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><span class="hs-identifier hs-type">MText</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-168"></a><span>  </span><a name="local-8214565720324200868"><a href="Lorentz.Errors.html#errorToVal"><span class="hs-identifier">errorToVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#isoErrorToVal"><span class="hs-identifier hs-var">isoErrorToVal</span></a><span>
</span><a name="line-169"></a><span>  </span><a name="local-8214565720324200869"><a href="Lorentz.Errors.html#errorFromVal"><span class="hs-identifier">errorFromVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#isoErrorFromVal"><span class="hs-identifier hs-var">isoErrorFromVal</span></a><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-keyword">instance</span><span> </span><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier hs-type">ErrorHasDoc</span></a><span> </span><span class="hs-identifier hs-type">MText</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-172"></a><span>  </span><a name="local-8214565720324200860"><a href="Lorentz.Errors.html#errorDocName"><span class="hs-identifier">errorDocName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;InternalError&quot;</span><span>
</span><a name="line-173"></a><span>  </span><a name="local-8214565720324200861"><a href="Lorentz.Errors.html#errorDocMdCause"><span class="hs-identifier">errorDocMdCause</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-string">&quot;Some internal error occured.&quot;</span><span>
</span><a name="line-175"></a><span>  </span><a name="local-8214565720324200863"><a href="Lorentz.Errors.html#errorDocHaskellRep"><span class="hs-identifier">errorDocHaskellRep</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-string">&quot;Textual error message, see &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-identifier hs-var">typeDocMdReference</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">MText</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">WithinParens</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-178"></a><span>  </span><a name="local-8214565720324200864"><a href="Lorentz.Errors.html#errorDocClass"><span class="hs-identifier">errorDocClass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#ErrClassContractInternal"><span class="hs-identifier hs-var">ErrClassContractInternal</span></a><span>
</span><a name="line-179"></a><span>  </span><a name="local-8214565720324200865"><a href="Lorentz.Errors.html#errorDocDependencies"><span class="hs-identifier">errorDocDependencies</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">SomeDocDefinitionItem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DType</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">MText</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;Use representative error messages&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-182"></a><span>  </span><a name="local-8214565720324200868"><a href="Lorentz.Errors.html#errorToVal"><span class="hs-identifier">errorToVal</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;impossible&quot;</span><span>
</span><a name="line-183"></a><span>  </span><a name="local-8214565720324200869"><a href="Lorentz.Errors.html#errorFromVal"><span class="hs-identifier">errorFromVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;impossible&quot;</span><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;Use representative error messages&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier hs-type">ErrorHasDoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-186"></a><span>  </span><a name="local-8214565720324200860"><a href="Lorentz.Errors.html#errorDocName"><span class="hs-identifier">errorDocName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;impossible&quot;</span><span>
</span><a name="line-187"></a><span>  </span><a name="local-8214565720324200861"><a href="Lorentz.Errors.html#errorDocMdCause"><span class="hs-identifier">errorDocMdCause</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;impossible&quot;</span><span>
</span><a name="line-188"></a><span>  </span><a name="local-8214565720324200863"><a href="Lorentz.Errors.html#errorDocHaskellRep"><span class="hs-identifier">errorDocHaskellRep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;impossible&quot;</span><span>
</span><a name="line-189"></a><span>  </span><a name="local-8214565720324200865"><a href="Lorentz.Errors.html#errorDocDependencies"><span class="hs-identifier">errorDocDependencies</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;impossible&quot;</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-comment">-- | Use this type as replacement for @()@ when you __really__ want to leave</span><span>
</span><a name="line-192"></a><span class="hs-comment">-- error cause unspecified.</span><span>
</span><a name="line-193"></a><span class="hs-keyword">data</span><span> </span><a name="UnspecifiedError"><a href="Lorentz.Errors.html#UnspecifiedError"><span class="hs-identifier">UnspecifiedError</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="UnspecifiedError"><a href="Lorentz.Errors.html#UnspecifiedError"><span class="hs-identifier">UnspecifiedError</span></a></a><span>
</span><a name="line-194"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span> </span><span class="hs-identifier hs-type">Generic</span><span>
</span><a name="line-195"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">anyclass</span><span> </span><span class="hs-identifier hs-type">IsoValue</span><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-keyword">instance</span><span> </span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><a href="Lorentz.Errors.html#UnspecifiedError"><span class="hs-identifier hs-type">UnspecifiedError</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-198"></a><span>  </span><a name="local-8214565720324200868"><a href="Lorentz.Errors.html#errorToVal"><span class="hs-identifier">errorToVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#isoErrorToVal"><span class="hs-identifier hs-var">isoErrorToVal</span></a><span>
</span><a name="line-199"></a><span>  </span><a name="local-8214565720324200869"><a href="Lorentz.Errors.html#errorFromVal"><span class="hs-identifier">errorFromVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#isoErrorFromVal"><span class="hs-identifier hs-var">isoErrorFromVal</span></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-keyword">instance</span><span> </span><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier hs-type">ErrorHasDoc</span></a><span> </span><a href="Lorentz.Errors.html#UnspecifiedError"><span class="hs-identifier hs-type">UnspecifiedError</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-202"></a><span>  </span><a name="local-8214565720324200860"><a href="Lorentz.Errors.html#errorDocName"><span class="hs-identifier">errorDocName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Unspecified error&quot;</span><span>
</span><a name="line-203"></a><span>  </span><a name="local-8214565720324200861"><a href="Lorentz.Errors.html#errorDocMdCause"><span class="hs-identifier">errorDocMdCause</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Some error occured.&quot;</span><span>
</span><a name="line-204"></a><span>  </span><a name="local-8214565720324200863"><a href="Lorentz.Errors.html#errorDocHaskellRep"><span class="hs-identifier">errorDocHaskellRep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeDocMdReference</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">WithinParens</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-205"></a><span>  </span><a name="local-8214565720324200865"><a href="Lorentz.Errors.html#errorDocDependencies"><span class="hs-identifier">errorDocDependencies</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeDocDependencies'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- General instructions</span><span>
</span><a name="line-209"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-comment">-- | Fail with the given Haskell value.</span><span>
</span><a name="line-212"></a><span class="hs-identifier">failUsing</span><span>
</span><a name="line-213"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679426395"><a href="#local-6989586621679426395"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679426396"><a href="#local-6989586621679426396"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679426397"><a href="#local-6989586621679426397"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-214"></a><span>     </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><a href="#local-6989586621679426395"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679426395"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lorentz.Base.html#%3A-%3E"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="Lorentz.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a><span> </span><a href="#local-6989586621679426397"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-216"></a><a name="failUsing"><a href="Lorentz.Errors.html#failUsing"><span class="hs-identifier">failUsing</span></a></a><span> </span><a name="local-6989586621679426747"><a href="#local-6989586621679426747"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-217"></a><span>  </span><a href="Lorentz.Errors.html#errorToVal"><span class="hs-identifier hs-var">errorToVal</span></a><span> </span><a href="#local-6989586621679426747"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679426748"><a href="#local-6989586621679426748"><span class="hs-identifier">eval</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-218"></a><span>    </span><a href="Lorentz.Doc.html#doc"><span class="hs-identifier hs-var">doc</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier hs-var">DThrows</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426395"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Lorentz.Base.html#%23"><span class="hs-operator hs-var">#</span></a><span>
</span><a name="line-219"></a><span>    </span><span class="hs-special">(</span><a href="Lorentz.Base.html#FI"><span class="hs-identifier hs-var">FI</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">PUSH</span><span> </span><a href="#local-6989586621679426748"><span class="hs-identifier hs-var">eval</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">FAILWITH</span><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-comment">-- | Fail, providing a reference to the place in the code where</span><span>
</span><a name="line-222"></a><span class="hs-comment">-- this function is called.</span><span>
</span><a name="line-223"></a><span class="hs-comment">--</span><span>
</span><a name="line-224"></a><span class="hs-comment">-- Like 'error' in Haskell code, this instruction is for internal errors only.</span><span>
</span><a name="line-225"></a><span class="hs-identifier">failUnexpected</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MText</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lorentz.Base.html#%3A-%3E"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="Lorentz.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a><span> </span><a href="#local-6989586621679426394"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-226"></a><a name="failUnexpected"><a href="Lorentz.Errors.html#failUnexpected"><span class="hs-identifier">failUnexpected</span></a></a><span> </span><a name="local-6989586621679426749"><a href="#local-6989586621679426749"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#failUsing"><span class="hs-identifier hs-var">failUsing</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="">[mt|Internal: |]</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679426749"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- Custom errors</span><span>
</span><a name="line-230"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-comment">{- | Declares a custom error, defining @error name - error argument@ relation.

If your error is supposed to carry no argument, then provide @()@.

Note that this relation is defined globally rather than on per-contract basis,
so define errors accordingly. If your error has argument specific to your
contract, call it such that error name reflects its belonging to this contract.

This is the basic [error format].
-}</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-comment">{- About global registry of errors:

Pros: this allows defining pieces of code which can be reused among the contracts.

Cons: possible name collisions. Example of worst case: two libraries define
different errors for the same tag, attempt to use both of these libraries would
cause compile-time error. But such infrastructure will barely take place in
practice.
-}</span><span>
</span><a name="line-252"></a><span class="hs-comment">{- For future work:

* Assosiating unique numeric error codes to tags, and put codes into
the contract instead of tags. This allows getting rid of overhead related to
often long tag literals.

* Allow using arbitrary type instead of tag (and 'KnownSymbol' constraint will
be replaced with a more generic one).
Some users may prefer using datatypes as tags rather than type-level strings as tags
because
  * there will be no orphan instances then
  * no problem with name collisions
  * compiler will prompt a hint in case of typo in tag name
  * in some cases autocomplete handles declarations in code better than strings
(and cons here is that each such tag will need to be declared first).

-}</span><span>
</span><a name="line-269"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="ErrorArg"><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier">ErrorArg</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679425993"><a href="#local-6989586621679425993"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind.Type</span><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-comment">-- | Material custom error.</span><span>
</span><a name="line-272"></a><span class="hs-comment">--</span><span>
</span><a name="line-273"></a><span class="hs-comment">-- Use this in pattern matches against error (e.g. in tests).</span><span>
</span><a name="line-274"></a><span class="hs-keyword">data</span><span> </span><a name="CustomError"><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier">CustomError</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679425992"><a href="#local-6989586621679425992"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Symbol</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="CustomError"><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier">CustomError</span></a></a><span>
</span><a name="line-275"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="ceTag"><a href="Lorentz.Errors.html#ceTag"><span class="hs-identifier">ceTag</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Label</span><span> </span><a href="#local-6989586621679425992"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-276"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="ceArg"><a href="Lorentz.Errors.html#ceArg"><span class="hs-identifier">ceArg</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679425992"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-277"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-278"></a><span>
</span><a name="line-279"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426824"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426824"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-280"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426823"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426823"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span class="hs-comment">-- | How 'CustomError' is actually represented in Michelson.</span><span>
</span><a name="line-283"></a><span class="hs-keyword">type</span><span> </span><a name="CustomErrorRep"><a href="Lorentz.Errors.html#CustomErrorRep"><span class="hs-identifier">CustomErrorRep</span></a></a><span> </span><a name="local-6989586621679425991"><a href="#local-6989586621679425991"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MText</span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679425991"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span class="hs-comment">-- | This instance cannot be implemented, use 'IsError' instance instead.</span><span>
</span><a name="line-286"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;CustomError has no IsoValue instance&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-287"></a><span>         </span><span class="hs-identifier hs-type">IsoValue</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426208"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-288"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ToT</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426208"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;CustomError has no IsoValue instance&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>  </span><a name="local-8214565720323813828"><span class="hs-identifier">toVal</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;impossible&quot;</span><span>
</span><a name="line-290"></a><span>  </span><a name="local-8214565720323813827"><span class="hs-identifier">fromVal</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;impossible&quot;</span><span>
</span><a name="line-291"></a><span>
</span><a name="line-292"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomErrorHasDoc"><span class="hs-identifier hs-type">CustomErrorHasDoc</span></a><span> </span><a href="#local-6989586621679426198"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#KnownError"><span class="hs-identifier hs-type">KnownError</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426198"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">IsoValue</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426198"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-293"></a><span>         </span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426198"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-294"></a><span>  </span><a name="local-8214565720324200868"><a href="Lorentz.Errors.html#errorToVal"><span class="hs-identifier">errorToVal</span></a></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-var">CustomError</span></a><span> </span><a name="local-6989586621679426199"><a href="#local-6989586621679426199"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679426200"><a href="#local-6989586621679426200"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679426201"><a href="#local-6989586621679426201"><span class="hs-identifier">cont</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-295"></a><span>    </span><a href="#local-6989586621679426201"><span class="hs-identifier hs-var">cont</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toVal</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomErrorRep"><span class="hs-identifier hs-type">CustomErrorRep</span></a><span> </span><a href="#local-6989586621679426198"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#errorTagToMText"><span class="hs-identifier hs-var">errorTagToMText</span></a><span> </span><a href="#local-6989586621679426199"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679426200"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span>
</span><a name="line-296"></a><span>  </span><a name="local-8214565720324200869"><a href="Lorentz.Errors.html#errorFromVal"><span class="hs-identifier">errorFromVal</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679426203"><a href="#local-6989586621679426203"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Value</span><span> </span><a href="#local-6989586621679426202"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-297"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679426204"><a href="#local-6989586621679426204"><span class="hs-identifier">expectedTag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#errorTagToMText"><span class="hs-identifier hs-var">errorTagToMText</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromLabel</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426198"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-298"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">cast</span><span> </span><a href="#local-6989586621679426203"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-299"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679426205"><a href="#local-6989586621679426205"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-300"></a><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679426206"><a href="#local-6989586621679426206"><span class="hs-identifier">tag</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679426207"><a href="#local-6989586621679426207"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromVal</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomErrorRep"><span class="hs-identifier hs-type">CustomErrorRep</span></a><span> </span><a href="#local-6989586621679426198"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679426205"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-301"></a><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679426206"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679426204"><span class="hs-identifier hs-var">expectedTag</span></a><span>
</span><a name="line-302"></a><span>             </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-var">CustomError</span></a><span> </span><span class="hs-identifier hs-var">fromLabel</span><span> </span><a href="#local-6989586621679426207"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-303"></a><span>             </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Bad tag, expected &quot;</span><span> </span><span class="hs-operator hs-var">+|</span><span> </span><a href="#local-6989586621679426204"><span class="hs-identifier hs-var">expectedTag</span></a><span> </span><span class="hs-operator hs-var">|+</span><span> </span><span class="hs-string">&quot;, got &quot;</span><span> </span><span class="hs-operator hs-var">+|</span><span> </span><a href="#local-6989586621679426206"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-operator hs-var">|+</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-304"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Wrong type for custom error: &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">pretty</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">demote</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426202"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomErrorHasDoc"><span class="hs-identifier hs-type">CustomErrorHasDoc</span></a><span> </span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SingI</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToT</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-307"></a><span>         </span><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier hs-type">ErrorHasDoc</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-308"></a><span>  </span><a name="local-8214565720324200860"><a href="Lorentz.Errors.html#errorDocName"><span class="hs-identifier">errorDocName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#errorTagToText"><span class="hs-identifier hs-var">errorTagToText</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-309"></a><span>  </span><a name="local-8214565720324200865"><a href="Lorentz.Errors.html#errorDocDependencies"><span class="hs-identifier">errorDocDependencies</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">SomeDocDefinitionItem</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">DType</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-310"></a><span>  </span><a name="local-8214565720324200861"><a href="Lorentz.Errors.html#errorDocMdCause"><span class="hs-identifier">errorDocMdCause</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#customErrDocMdCause"><span class="hs-identifier hs-var">customErrDocMdCause</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-311"></a><span>  </span><a name="local-8214565720324200862"><a href="Lorentz.Errors.html#errorDocMdCauseInEntrypoint"><span class="hs-identifier">errorDocMdCauseInEntrypoint</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#customErrDocMdCauseInEntrypoint"><span class="hs-identifier hs-var">customErrDocMdCauseInEntrypoint</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-312"></a><span>  </span><a name="local-8214565720324200864"><a href="Lorentz.Errors.html#errorDocClass"><span class="hs-identifier">errorDocClass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#customErrClass"><span class="hs-identifier hs-var">customErrClass</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-313"></a><span>  </span><a name="local-8214565720324200863"><a href="Lorentz.Errors.html#errorDocHaskellRep"><span class="hs-identifier">errorDocHaskellRep</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-314"></a><span>    </span><a href="Lorentz.Errors.html#customErrorDocHaskellRepGeneral"><span class="hs-identifier hs-var">customErrorDocHaskellRepGeneral</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Lorentz.Errors.html#errorTagToText"><span class="hs-identifier hs-var">errorTagToText</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ErrorRequirements</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomErrorHasDoc"><span class="hs-identifier hs-type">CustomErrorHasDoc</span></a><span> </span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SingI</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToT</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426197"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-317"></a><span>  </span><a name="local-8214565720324200866"><a href="Lorentz.Errors.html#errorDocRequirements"><span class="hs-identifier">errorDocRequirements</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Dict</span><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-comment">-- | Description of error representation in Haskell.</span><span>
</span><a name="line-320"></a><span class="hs-identifier">customErrorDocHaskellRepGeneral</span><span>
</span><a name="line-321"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">SingI</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToT</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426392"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426392"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-322"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TypeHasDoc</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426392"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#CustomErrorHasDoc"><span class="hs-identifier hs-type">CustomErrorHasDoc</span></a><span> </span><a href="#local-6989586621679426392"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-323"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-324"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679426392"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Markdown</span><span>
</span><a name="line-325"></a><a name="customErrorDocHaskellRepGeneral"><a href="Lorentz.Errors.html#customErrorDocHaskellRepGeneral"><span class="hs-identifier">customErrorDocHaskellRepGeneral</span></a></a><span> </span><a name="local-6989586621679426763"><a href="#local-6989586621679426763"><span class="hs-identifier">tagName</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679426764"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-326"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679426765"><a href="#local-6989586621679426765"><span class="hs-identifier">hasArg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">demote</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToT</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426764"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">TUnit</span><span>
</span><a name="line-327"></a><span>      </span><a name="local-6989586621679426766"><a href="#local-6989586621679426766"><span class="hs-identifier">tagName'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><a href="#local-6989586621679426763"><span class="hs-identifier hs-var">tagName</span></a><span>
</span><a name="line-328"></a><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">mconcat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">catMaybes</span><span>
</span><a name="line-329"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-330"></a><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679426765"><span class="hs-identifier hs-var">hasArg</span></a><span>
</span><a name="line-331"></a><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">mdTicked</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679426766"><span class="hs-identifier hs-var">tagName'</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;&lt;error argument&gt;&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-332"></a><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">mdTicked</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679426766"><span class="hs-identifier hs-var">tagName'</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;, ())&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-334"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">guard</span><span> </span><a href="#local-6989586621679426765"><span class="hs-identifier hs-var">hasArg</span></a><span> </span><span class="hs-operator hs-var">$&gt;</span><span>
</span><a name="line-335"></a><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;\n\nProvided error argument will be of type &quot;</span><span>
</span><a name="line-336"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">typeDocMdReference</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426764"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">WithinParens</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-337"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679426791"><a href="#local-6989586621679426791"><span class="hs-identifier">txt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot; and stand for &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679426791"><span class="hs-identifier hs-var">txt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#customErrArgumentSemantics"><span class="hs-identifier hs-var">customErrArgumentSemantics</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426764"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-338"></a><span>        </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-339"></a><span>        </span><span class="hs-special">)</span><span>
</span><a name="line-340"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">-- | Demote error tag to term level.</span><span>
</span><a name="line-343"></a><span class="hs-identifier">errorTagToMText</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Label</span><span> </span><a href="#local-6989586621679426391"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">MText</span><span>
</span><a name="line-344"></a><a name="errorTagToMText"><a href="Lorentz.Errors.html#errorTagToMText"><span class="hs-identifier">errorTagToMText</span></a></a><span> </span><a name="local-6989586621679426792"><a href="#local-6989586621679426792"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-345"></a><span>  </span><span class="hs-comment">-- Now tags come not from constructor names, but from labels,</span><span>
</span><a name="line-346"></a><span>  </span><span class="hs-comment">-- we have to lead the first letter to upper case to preserve</span><span>
</span><a name="line-347"></a><span>  </span><span class="hs-comment">-- compatibility with FA1.2 interface.</span><span>
</span><a name="line-348"></a><span>  </span><span class="hs-identifier hs-var">mtextHeadToUpper</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-349"></a><span>    </span><span class="hs-identifier hs-var">labelToMText</span><span> </span><a href="#local-6989586621679426792"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-identifier">errorTagToText</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679426390"><a href="#local-6989586621679426390"><span class="hs-identifier">tag</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">KnownSymbol</span><span> </span><a href="#local-6989586621679426390"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-352"></a><a name="errorTagToText"><a href="Lorentz.Errors.html#errorTagToText"><span class="hs-identifier">errorTagToText</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toText</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Lorentz.Errors.html#errorTagToMText"><span class="hs-identifier hs-var">errorTagToMText</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromLabel</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426390"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-comment">-- | Fail with given custom error.</span><span>
</span><a name="line-355"></a><span class="hs-identifier">failCustom</span><span>
</span><a name="line-356"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679426386"><a href="#local-6989586621679426386"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679426387"><a href="#local-6989586621679426387"><span class="hs-identifier">err</span></a></a><span> </span><a name="local-6989586621679426388"><a href="#local-6989586621679426388"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679426389"><a href="#local-6989586621679426389"><span class="hs-identifier">any</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-357"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">err</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426386"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-358"></a><span>     </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#CustomErrorHasDoc"><span class="hs-identifier hs-type">CustomErrorHasDoc</span></a><span> </span><a href="#local-6989586621679426386"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-359"></a><span>     </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#KnownError"><span class="hs-identifier hs-type">KnownError</span></a><span> </span><a href="#local-6989586621679426387"><span class="hs-identifier hs-type">err</span></a><span>
</span><a name="line-360"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-361"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Label</span><span> </span><a href="#local-6989586621679426386"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lorentz.Base.html#%3A-%3E"><span class="hs-identifier hs-type">err</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679426388"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-operator">:-&gt;</span><span> </span><a href="#local-6989586621679426389"><span class="hs-identifier hs-type">any</span></a><span>
</span><a name="line-362"></a><a name="failCustom"><a href="Lorentz.Errors.html#failCustom"><span class="hs-identifier">failCustom</span></a></a><span> </span><a name="local-6989586621679426793"><a href="#local-6989586621679426793"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-363"></a><span>  </span><a href="Lorentz.Doc.html#doc"><span class="hs-identifier hs-var">doc</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier hs-var">DThrows</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426386"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Lorentz.Base.html#%23"><span class="hs-operator hs-var">#</span></a><span>
</span><a name="line-364"></a><span>  </span><a href="Lorentz.Instr.html#push"><span class="hs-identifier hs-var">push</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#errorTagToMText"><span class="hs-identifier hs-var">errorTagToMText</span></a><span> </span><a href="#local-6989586621679426793"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="Lorentz.Base.html#%23"><span class="hs-operator hs-var">#</span></a><span> </span><a href="Lorentz.Instr.html#pair"><span class="hs-identifier hs-var">pair</span></a><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">MText</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426387"><span class="hs-identifier hs-type">err</span></a><span> </span><a href="Lorentz.Base.html#%23"><span class="hs-operator hs-var">#</span></a><span>
</span><a name="line-365"></a><span>  </span><a href="Lorentz.Base.html#FI"><span class="hs-identifier hs-var">FI</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FAILWITH</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToT</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomErrorRep"><span class="hs-identifier hs-type">CustomErrorRep</span></a><span> </span><a href="#local-6989586621679426386"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-366"></a><span>
</span><a name="line-367"></a><span class="hs-keyword">type</span><span> </span><a name="RequireNoArgError"><a href="Lorentz.Errors.html#RequireNoArgError"><span class="hs-identifier">RequireNoArgError</span></a></a><span> </span><a name="local-6989586621679425989"><a href="#local-6989586621679425989"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679425990"><a href="#local-6989586621679425990"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-368"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">TypeErrorUnless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ErrorArg</span><span> </span><a href="#local-6989586621679425989"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679425990"><span class="hs-identifier hs-type">msg</span></a><span>
</span><a name="line-369"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">msg</span><span> </span><span class="hs-glyph">~</span><span>
</span><a name="line-370"></a><span>    </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;Expected no-arg error, but given error requires argument of type &quot;</span><span>
</span><a name="line-371"></a><span>      </span><span class="hs-special">'</span><span class="hs-operator hs-type">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679425989"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-373"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-comment">-- | Specialization of 'failCustom' for no-arg errors.</span><span>
</span><a name="line-376"></a><span class="hs-identifier">failCustom_</span><span>
</span><a name="line-377"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679426382"><a href="#local-6989586621679426382"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679426383"><a href="#local-6989586621679426383"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679426384"><a href="#local-6989586621679426384"><span class="hs-identifier">any</span></a></a><span> </span><a name="local-6989586621679426385"><a href="#local-6989586621679426385"><span class="hs-identifier">notVoidErrorMsg</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-378"></a><span>     </span><span class="hs-special">(</span><span> </span><a href="Lorentz.Errors.html#RequireNoArgError"><span class="hs-identifier hs-type">RequireNoArgError</span></a><span> </span><a href="#local-6989586621679426382"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679426385"><span class="hs-identifier hs-type">notVoidErrorMsg</span></a><span>
</span><a name="line-379"></a><span>     </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#CustomErrorHasDoc"><span class="hs-identifier hs-type">CustomErrorHasDoc</span></a><span> </span><a href="#local-6989586621679426382"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-380"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-381"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Label</span><span> </span><a href="#local-6989586621679426382"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lorentz.Base.html#%3A-%3E"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="Lorentz.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a><span> </span><a href="#local-6989586621679426384"><span class="hs-identifier hs-type">any</span></a><span>
</span><a name="line-382"></a><a name="failCustom_"><a href="Lorentz.Errors.html#failCustom_"><span class="hs-identifier">failCustom_</span></a></a><span> </span><a name="local-6989586621679426794"><a href="#local-6989586621679426794"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-383"></a><span>  </span><span class="hs-identifier hs-var">inTypeErrorUnless</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-type">ErrorArg</span><span> </span><a href="#local-6989586621679426382"><span class="hs-identifier hs-type">tag</span></a><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426385"><span class="hs-identifier hs-type">notVoidErrorMsg</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-384"></a><span>  </span><span class="hs-identifier hs-var">reifyTypeEquality</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426382"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-385"></a><span>    </span><span class="hs-keyword">unit</span><span> </span><a href="Lorentz.Base.html#%23"><span class="hs-operator hs-var">#</span></a><span> </span><a href="Lorentz.Errors.html#failCustom"><span class="hs-identifier hs-var">failCustom</span></a><span> </span><a href="#local-6989586621679426794"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span class="hs-comment">-- Special treatment of no-arg errors</span><span>
</span><a name="line-388"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-389"></a><span>
</span><a name="line-390"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426194"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426194"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-391"></a><span>  </span><a name="local-6989586621679426195"><a href="#local-6989586621679426195"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621679426196"><a href="#local-6989586621679426196"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679426195"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679426196"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-392"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426192"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426192"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-393"></a><span>  </span><a name="local-8214565720323784705"><span class="hs-identifier">show</span></a><span> </span><a name="local-6989586621679426193"><a href="#local-6989586621679426193"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679426193"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span class="hs-comment">-- | If 'CustomError' constructor is not provided its argument, we assume</span><span>
</span><a name="line-396"></a><span class="hs-comment">-- that this is no-arg error and interpret the passed value as complete.</span><span>
</span><a name="line-397"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679426185"><span class="hs-identifier hs-type">arg</span></a><span>
</span><a name="line-398"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426186"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-399"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TypeErrorUnless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">arg</span><span> </span><span class="hs-operator hs-type">==</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679426187"><span class="hs-identifier hs-type">notVoidError</span></a><span>
</span><a name="line-400"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">arg</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426186"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-401"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">notVoidError</span><span> </span><span class="hs-glyph">~</span><span>
</span><a name="line-402"></a><span>            </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;This error requires argument of type &quot;</span><span>
</span><a name="line-403"></a><span>              </span><span class="hs-special">'</span><span class="hs-operator hs-type">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679426186"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>            </span><span class="hs-special">)</span><span>
</span><a name="line-405"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-406"></a><span>         </span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679426185"><span class="hs-identifier hs-type">arg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426186"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-407"></a><span>  </span><a name="local-8214565720324200868"><a href="Lorentz.Errors.html#errorToVal"><span class="hs-identifier">errorToVal</span></a></a><span> </span><a name="local-6989586621679426188"><a href="#local-6989586621679426188"><span class="hs-identifier">mkCustomError</span></a></a><span> </span><a name="local-6989586621679426189"><a href="#local-6989586621679426189"><span class="hs-identifier">cont</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-408"></a><span>    </span><span class="hs-identifier hs-var">inTypeErrorUnless</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-type">arg</span><span> </span><span class="hs-operator hs-type">==</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426187"><span class="hs-identifier hs-type">notVoidError</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-409"></a><span>    </span><span class="hs-identifier hs-var">reifyTypeEquality</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426185"><span class="hs-identifier hs-type">arg</span></a><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-410"></a><span>      </span><a href="Lorentz.Errors.html#errorToVal"><span class="hs-identifier hs-var">errorToVal</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679426188"><span class="hs-identifier hs-var">mkCustomError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679426189"><span class="hs-identifier hs-var">cont</span></a><span>
</span><a name="line-411"></a><span>  </span><a name="local-8214565720324200869"><a href="Lorentz.Errors.html#errorFromVal"><span class="hs-identifier">errorFromVal</span></a></a><span> </span><a name="local-6989586621679426190"><a href="#local-6989586621679426190"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-412"></a><span>    </span><span class="hs-identifier hs-var">inTypeErrorUnless</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-type">arg</span><span> </span><span class="hs-operator hs-type">==</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426187"><span class="hs-identifier hs-type">notVoidError</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-413"></a><span>    </span><span class="hs-identifier hs-var">reifyTypeEquality</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426185"><span class="hs-identifier hs-type">arg</span></a><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-414"></a><span>      </span><a href="Lorentz.Errors.html#errorFromVal"><span class="hs-identifier hs-var">errorFromVal</span></a><span> </span><a href="#local-6989586621679426190"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">&lt;&amp;&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-var">CustomError</span></a><span> </span><a name="local-6989586621679426191"><a href="#local-6989586621679426191"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-var">CustomError</span></a><span> </span><a href="#local-6989586621679426191"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-415"></a><span>
</span><a name="line-416"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679426183"><span class="hs-identifier hs-type">arg</span></a><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier hs-type">ErrorHasDoc</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426184"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-417"></a><span>         </span><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier hs-type">ErrorHasDoc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679426183"><span class="hs-identifier hs-type">arg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426184"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-418"></a><span>  </span><a name="local-8214565720324200860"><a href="Lorentz.Errors.html#errorDocName"><span class="hs-identifier">errorDocName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#errorDocName"><span class="hs-identifier hs-var">errorDocName</span></a><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426184"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-419"></a><span>  </span><a name="local-8214565720324200862"><a href="Lorentz.Errors.html#errorDocMdCauseInEntrypoint"><span class="hs-identifier">errorDocMdCauseInEntrypoint</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#errorDocMdCauseInEntrypoint"><span class="hs-identifier hs-var">errorDocMdCauseInEntrypoint</span></a><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426184"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-420"></a><span>  </span><a name="local-8214565720324200861"><a href="Lorentz.Errors.html#errorDocMdCause"><span class="hs-identifier">errorDocMdCause</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#errorDocMdCause"><span class="hs-identifier hs-var">errorDocMdCause</span></a><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426184"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-421"></a><span>  </span><a name="local-8214565720324200863"><a href="Lorentz.Errors.html#errorDocHaskellRep"><span class="hs-identifier">errorDocHaskellRep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#errorDocHaskellRep"><span class="hs-identifier hs-var">errorDocHaskellRep</span></a><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426184"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-422"></a><span>  </span><a name="local-8214565720324200865"><a href="Lorentz.Errors.html#errorDocDependencies"><span class="hs-identifier">errorDocDependencies</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#errorDocDependencies"><span class="hs-identifier hs-var">errorDocDependencies</span></a><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679426184"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-423"></a><span>
</span><a name="line-424"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-425"></a><span class="hs-comment">-- Errors documentation injection into contracts</span><span>
</span><a name="line-426"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-427"></a><span>
</span><a name="line-428"></a><span class="hs-comment">-- | Error class on how the error should be handled by the client.</span><span>
</span><a name="line-429"></a><span class="hs-keyword">data</span><span> </span><a name="ErrorClass"><a href="Lorentz.Errors.html#ErrorClass"><span class="hs-identifier">ErrorClass</span></a></a><span>
</span><a name="line-430"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="ErrClassActionException"><a href="Lorentz.Errors.html#ErrClassActionException"><span class="hs-identifier">ErrClassActionException</span></a></a><span>
</span><a name="line-431"></a><span>    </span><span class="hs-comment">-- ^ Normal expected error.</span><span>
</span><a name="line-432"></a><span>    </span><span class="hs-comment">-- Examples: &quot;insufficient balance&quot;, &quot;wallet does not exist&quot;.</span><span>
</span><a name="line-433"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ErrClassBadArgument"><a href="Lorentz.Errors.html#ErrClassBadArgument"><span class="hs-identifier">ErrClassBadArgument</span></a></a><span>
</span><a name="line-434"></a><span>    </span><span class="hs-comment">-- ^ Invalid argument passed to entrypoint.</span><span>
</span><a name="line-435"></a><span>    </span><span class="hs-comment">-- Examples: your entrypoint accepts an enum represented as @nat@, and</span><span>
</span><a name="line-436"></a><span>    </span><span class="hs-comment">-- unknown value is provided.</span><span>
</span><a name="line-437"></a><span>    </span><span class="hs-comment">-- This includes more complex cases which involve multiple entrypoints.</span><span>
</span><a name="line-438"></a><span>    </span><span class="hs-comment">-- E.g. API provides iterator interface, middleware should care about using it</span><span>
</span><a name="line-439"></a><span>    </span><span class="hs-comment">-- hiding complex details and exposing a simpler API to user; then an attempt to</span><span>
</span><a name="line-440"></a><span>    </span><span class="hs-comment">-- request non-existing element would also correspond to an error from this class.</span><span>
</span><a name="line-441"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ErrClassContractInternal"><a href="Lorentz.Errors.html#ErrClassContractInternal"><span class="hs-identifier">ErrClassContractInternal</span></a></a><span>
</span><a name="line-442"></a><span>    </span><span class="hs-comment">-- ^ Unexpected error. Most likely it means that there is a bug in</span><span>
</span><a name="line-443"></a><span>    </span><span class="hs-comment">-- the contract or the contract has been deployed incorrectly.</span><span>
</span><a name="line-444"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ErrClassUnknown"><a href="Lorentz.Errors.html#ErrClassUnknown"><span class="hs-identifier">ErrClassUnknown</span></a></a><span>
</span><a name="line-445"></a><span>    </span><span class="hs-comment">-- ^ It's possible to leave error class unspecified.</span><span>
</span><a name="line-446"></a><span>
</span><a name="line-447"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><a href="Lorentz.Errors.html#ErrorClass"><span class="hs-identifier hs-type">ErrorClass</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-448"></a><span>  </span><a name="local-8214565720323801287"><span class="hs-identifier">build</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-449"></a><span>    </span><a href="Lorentz.Errors.html#ErrClassActionException"><span class="hs-identifier hs-var">ErrClassActionException</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;Action exception&quot;</span><span>
</span><a name="line-450"></a><span>    </span><a href="Lorentz.Errors.html#ErrClassBadArgument"><span class="hs-identifier hs-var">ErrClassBadArgument</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;Bad argument&quot;</span><span>
</span><a name="line-451"></a><span>    </span><a href="Lorentz.Errors.html#ErrClassContractInternal"><span class="hs-identifier hs-var">ErrClassContractInternal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;Internal&quot;</span><span>
</span><a name="line-452"></a><span>    </span><a href="Lorentz.Errors.html#ErrClassUnknown"><span class="hs-identifier hs-var">ErrClassUnknown</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;-&quot;</span><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span class="hs-identifier">isInternalErrorClass</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lorentz.Errors.html#ErrorClass"><span class="hs-identifier hs-type">ErrorClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-455"></a><a name="isInternalErrorClass"><a href="Lorentz.Errors.html#isInternalErrorClass"><span class="hs-identifier">isInternalErrorClass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-456"></a><span>  </span><a href="Lorentz.Errors.html#ErrClassActionException"><span class="hs-identifier hs-var">ErrClassActionException</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-457"></a><span>  </span><a href="Lorentz.Errors.html#ErrClassBadArgument"><span class="hs-identifier hs-var">ErrClassBadArgument</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-458"></a><span>  </span><a href="Lorentz.Errors.html#ErrClassContractInternal"><span class="hs-identifier hs-var">ErrClassContractInternal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-459"></a><span>  </span><a href="Lorentz.Errors.html#ErrClassUnknown"><span class="hs-identifier hs-var">ErrClassUnknown</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-460"></a><span>
</span><a name="line-461"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">KnownSymbol</span><span> </span><a href="#local-6989586621679425988"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TypeHasDoc</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#ErrorArg"><span class="hs-identifier hs-type">ErrorArg</span></a><span> </span><a href="#local-6989586621679425988"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#CustomError"><span class="hs-identifier hs-type">CustomError</span></a><span> </span><a href="#local-6989586621679425988"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-462"></a><span>      </span><a name="CustomErrorHasDoc"><a href="Lorentz.Errors.html#CustomErrorHasDoc"><span class="hs-identifier">CustomErrorHasDoc</span></a></a><span> </span><a name="local-6989586621679425988"><a href="#local-6989586621679425988"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-463"></a><span>  </span><span class="hs-comment">-- | What should happen for this error to be raised.</span><span>
</span><a name="line-464"></a><span>  </span><a name="customErrDocMdCause"><a href="Lorentz.Errors.html#customErrDocMdCause"><span class="hs-identifier">customErrDocMdCause</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Markdown</span><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><span>  </span><span class="hs-comment">-- | Brief version of 'customErrDocMdCause'.</span><span>
</span><a name="line-467"></a><span>  </span><span class="hs-comment">-- This will appear along with the error when mentioned in entrypoint description.</span><span>
</span><a name="line-468"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-469"></a><span>  </span><span class="hs-comment">-- By default, the first sentence of the full description is used.</span><span>
</span><a name="line-470"></a><span>  </span><a name="customErrDocMdCauseInEntrypoint"><a href="Lorentz.Errors.html#customErrDocMdCauseInEntrypoint"><span class="hs-identifier">customErrDocMdCauseInEntrypoint</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Markdown</span><span>
</span><a name="line-471"></a><span>  </span><a name="local-8214565720324200841"><a href="Lorentz.Errors.html#customErrDocMdCauseInEntrypoint"><span class="hs-identifier">customErrDocMdCauseInEntrypoint</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#pickFirstSentence"><span class="hs-identifier hs-var">pickFirstSentence</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Lorentz.Errors.html#customErrDocMdCause"><span class="hs-identifier hs-var">customErrDocMdCause</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679425988"><span class="hs-identifier hs-type">tag</span></a><span>
</span><a name="line-472"></a><span>
</span><a name="line-473"></a><span>  </span><span class="hs-comment">-- | Error class.</span><span>
</span><a name="line-474"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-475"></a><span>  </span><span class="hs-comment">-- By default this returns &quot;unknown error&quot; class; though you should provide</span><span>
</span><a name="line-476"></a><span>  </span><span class="hs-comment">-- explicit implementation in order to avoid a warning.</span><span>
</span><a name="line-477"></a><span>  </span><a name="customErrClass"><a href="Lorentz.Errors.html#customErrClass"><span class="hs-identifier">customErrClass</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lorentz.Errors.html#ErrorClass"><span class="hs-identifier hs-type">ErrorClass</span></a><span>
</span><a name="line-478"></a><span>  </span><a name="local-8214565720324200842"><a href="Lorentz.Errors.html#customErrClass"><span class="hs-identifier">customErrClass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#ErrClassUnknown"><span class="hs-identifier hs-var">ErrClassUnknown</span></a><span>
</span><a name="line-479"></a><span>
</span><a name="line-480"></a><span>  </span><span class="hs-comment">-- | Clarification of error argument meaning.</span><span>
</span><a name="line-481"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-482"></a><span>  </span><span class="hs-comment">-- Provide when it's not obvious, e.g. argument is not named with ':!'.</span><span>
</span><a name="line-483"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-484"></a><span>  </span><span class="hs-comment">-- NOTE: This should /not/ be an entire sentence, rather just the semantic</span><span>
</span><a name="line-485"></a><span>  </span><span class="hs-comment">-- backbone.</span><span>
</span><a name="line-486"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-487"></a><span>  </span><span class="hs-comment">-- Bad:</span><span>
</span><a name="line-488"></a><span>  </span><span class="hs-comment">-- * @Error argument stands for the previous value of approval.@</span><span>
</span><a name="line-489"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-490"></a><span>  </span><span class="hs-comment">-- Good:</span><span>
</span><a name="line-491"></a><span>  </span><span class="hs-comment">-- * @the previous value of approval@</span><span>
</span><a name="line-492"></a><span>  </span><span class="hs-comment">-- * @pair, first argument of which is one thing, and the second is another@</span><span>
</span><a name="line-493"></a><span>  </span><a name="customErrArgumentSemantics"><a href="Lorentz.Errors.html#customErrArgumentSemantics"><span class="hs-identifier">customErrArgumentSemantics</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Markdown</span><span>
</span><a name="line-494"></a><span>  </span><a name="local-8214565720324200843"><a href="Lorentz.Errors.html#customErrArgumentSemantics"><span class="hs-identifier">customErrArgumentSemantics</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-495"></a><span>  </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="hs-pragma">customErrDocMdCause</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">customErrClass</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span class="hs-comment">-- | Mentions that contract uses given error.</span><span>
</span><a name="line-498"></a><span class="hs-keyword">data</span><span> </span><a name="DError"><a href="Lorentz.Errors.html#DError"><span class="hs-identifier">DError</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-499"></a><span>  </span><a name="DError"><a href="Lorentz.Errors.html#DError"><span class="hs-identifier">DError</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier hs-type">ErrorHasDoc</span></a><span> </span><a href="#local-6989586621679425987"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679425987"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-type">DError</span></a><span>
</span><a name="line-500"></a><span>
</span><a name="line-501"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-type">DError</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-502"></a><span>  </span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-var">DError</span></a><span> </span><a name="local-6989586621679426181"><a href="#local-6989586621679426181"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-var">DError</span></a><span> </span><a name="local-6989586621679426182"><a href="#local-6989586621679426182"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679426181"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">eqParam1</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679426182"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-503"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-type">DError</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-504"></a><span>  </span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-var">DError</span></a><span> </span><a name="local-6989586621679426179"><a href="#local-6989586621679426179"><span class="hs-identifier">e1</span></a></a><span> </span><span class="hs-special">`</span><a name="local-8214565720323786471"><span class="hs-identifier">compare</span></a><span class="hs-special">`</span><span> </span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-var">DError</span></a><span> </span><a name="local-6989586621679426180"><a href="#local-6989586621679426180"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679426179"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compareExt</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679426180"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-505"></a><span>
</span><a name="line-506"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">DocItem</span><span> </span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-type">DError</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-507"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">DocItemPosition</span><span> </span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-type">DError</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">5010</span><span>
</span><a name="line-508"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">DocItemPlacement</span><span> </span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-type">DError</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">DocItemInDefinitions</span><span>
</span><a name="line-509"></a><span>  </span><a name="local-8214565720323814093"><span class="hs-identifier">docItemSectionName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-string">&quot;Errors&quot;</span><span>
</span><a name="line-510"></a><span>  </span><a name="local-8214565720323814092"><span class="hs-identifier">docItemSectionDescription</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="Lorentz.Errors.html#errorsDocumentation"><span class="hs-identifier hs-var">errorsDocumentation</span></a><span>
</span><a name="line-511"></a><span>  </span><a name="local-8214565720323814090"><span class="hs-identifier">docItemRef</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-var">DError</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679426175"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DocItemRef</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-512"></a><span>    </span><span class="hs-identifier hs-var">DocItemId</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;errors-&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Lorentz.Errors.html#errorDocName"><span class="hs-identifier hs-var">errorDocName</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426175"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-513"></a><span>  </span><a name="local-8214565720323814089"><span class="hs-identifier">docItemToMarkdown</span></a><span> </span><a name="local-6989586621679426176"><a href="#local-6989586621679426176"><span class="hs-identifier">lvl</span></a></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-var">DError</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679426177"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-514"></a><span>    </span><span class="hs-identifier hs-var">mconcat</span><span>
</span><a name="line-515"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">mdSeparator</span><span>
</span><a name="line-516"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mdHeader</span><span> </span><a href="#local-6989586621679426176"><span class="hs-identifier hs-var">lvl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mdTicked</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Lorentz.Errors.html#errorDocName"><span class="hs-identifier hs-var">errorDocName</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426177"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-517"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mdSubsection</span><span> </span><span class="hs-string">&quot;Class&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Lorentz.Errors.html#errorDocClass"><span class="hs-identifier hs-var">errorDocClass</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426177"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-518"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;\n\n&quot;</span><span>
</span><a name="line-519"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mdSubsection</span><span> </span><span class="hs-string">&quot;Fires if&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Lorentz.Errors.html#errorDocMdCause"><span class="hs-identifier hs-var">errorDocMdCause</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426177"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-520"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;\n\n&quot;</span><span>
</span><a name="line-521"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mdSubsection</span><span> </span><span class="hs-string">&quot;Representation&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Lorentz.Errors.html#errorDocHaskellRep"><span class="hs-identifier hs-var">errorDocHaskellRep</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426177"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-522"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-523"></a><span>  </span><a name="local-8214565720323814088"><span class="hs-identifier">docItemDependencies</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-var">DError</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679426178"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#errorDocDependencies"><span class="hs-identifier hs-var">errorDocDependencies</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426178"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-524"></a><span>
</span><a name="line-525"></a><span class="hs-identifier">errorDocMdReference</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679426381"><a href="#local-6989586621679426381"><span class="hs-identifier">e</span></a></a><span class="hs-operator">.</span><span> </span><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier hs-type">ErrorHasDoc</span></a><span> </span><a href="#local-6989586621679426381"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Markdown</span><span>
</span><a name="line-526"></a><a name="errorDocMdReference"><a href="Lorentz.Errors.html#errorDocMdReference"><span class="hs-identifier">errorDocMdReference</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-527"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier hs-var">DocItemRef</span><span> </span><a name="local-6989586621679426795"><a href="#local-6989586621679426795"><span class="hs-identifier">docItemId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">docItemRef</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-var">DError</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426381"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-528"></a><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">mdLocalRef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mdTicked</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Lorentz.Errors.html#errorDocName"><span class="hs-identifier hs-var">errorDocName</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426381"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679426795"><span class="hs-identifier hs-var">docItemId</span></a><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span class="hs-comment">-- | Documentation for custom errors.</span><span>
</span><a name="line-531"></a><span>
</span><a name="line-532"></a><span class="hs-comment">-- | Mentions that entrypoint throws given error.</span><span>
</span><a name="line-533"></a><span class="hs-keyword">data</span><span> </span><a name="DThrows"><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier">DThrows</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-534"></a><span>  </span><a name="DThrows"><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier">DThrows</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier hs-type">ErrorHasDoc</span></a><span> </span><a href="#local-6989586621679425986"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679425986"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier hs-type">DThrows</span></a><span>
</span><a name="line-535"></a><span>
</span><a name="line-536"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier hs-type">DThrows</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-537"></a><span>  </span><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier hs-var">DThrows</span></a><span> </span><a name="local-6989586621679426173"><a href="#local-6989586621679426173"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier hs-var">DThrows</span></a><span> </span><a name="local-6989586621679426174"><a href="#local-6989586621679426174"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">eqParam1</span><span> </span><a href="#local-6989586621679426173"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679426174"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-538"></a><span>
</span><a name="line-539"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">DocItem</span><span> </span><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier hs-type">DThrows</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-540"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">DocItemPosition</span><span> </span><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier hs-type">DThrows</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">5011</span><span>
</span><a name="line-541"></a><span>  </span><a name="local-8214565720323814093"><span class="hs-identifier">docItemSectionName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-string">&quot;Possible errors&quot;</span><span>
</span><a name="line-542"></a><span>  </span><a name="local-8214565720323814091"><span class="hs-identifier">docItemSectionNameStyle</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DocSectionNameSmall</span><span>
</span><a name="line-543"></a><span>  </span><a name="local-8214565720323814088"><span class="hs-identifier">docItemDependencies</span></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier hs-var">DThrows</span></a><span> </span><a name="local-6989586621679426002"><a href="#local-6989586621679426002"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-544"></a><span>    </span><span class="hs-special">[</span><span class="hs-identifier hs-var">SomeDocDefinitionItem</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-var">DError</span></a><span> </span><a href="#local-6989586621679426002"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-545"></a><span>  </span><a name="local-8214565720323814089"><span class="hs-identifier">docItemToMarkdown</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier hs-var">DThrows</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679426003"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-546"></a><span>    </span><span class="hs-string">&quot;* &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Lorentz.Errors.html#errorDocMdReference"><span class="hs-identifier hs-var">errorDocMdReference</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426003"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &#8212; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Lorentz.Errors.html#errorDocMdCauseInEntrypoint"><span class="hs-identifier hs-var">errorDocMdCauseInEntrypoint</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426003"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-547"></a><span>  </span><a name="local-8214565720323814087"><span class="hs-identifier">docItemsOrder</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-548"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679426004"><a href="#local-6989586621679426004"><span class="hs-identifier">errType</span></a></a><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#DThrows"><span class="hs-identifier hs-var">DThrows</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679426005"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#errorDocClass"><span class="hs-identifier hs-var">errorDocClass</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426005"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-549"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">L.nub</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Prelude.not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Lorentz.Errors.html#isInternalErrorClass"><span class="hs-identifier hs-var">isInternalErrorClass</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679426004"><span class="hs-identifier hs-var">errType</span></a><span class="hs-special">)</span><span>
</span><a name="line-550"></a><span>
</span><a name="line-551"></a><span class="hs-comment">-- | Implementation of 'typeDocMdDescription' (of 'TypeHasDoc' typeclass)</span><span>
</span><a name="line-552"></a><span class="hs-comment">-- for Haskell types which sole purpose is to be error.</span><span>
</span><a name="line-553"></a><span class="hs-identifier">typeDocMdDescriptionReferToError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679426380"><a href="#local-6989586621679426380"><span class="hs-identifier">e</span></a></a><span class="hs-operator">.</span><span> </span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><a href="#local-6989586621679426380"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Markdown</span><span>
</span><a name="line-554"></a><a name="typeDocMdDescriptionReferToError"><a href="Lorentz.Errors.html#typeDocMdDescriptionReferToError"><span class="hs-identifier">typeDocMdDescriptionReferToError</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-555"></a><span>  </span><span class="hs-string">&quot;This type is primarily used as error, see &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span>
</span><a name="line-556"></a><span>  </span><span class="hs-identifier hs-var">docDefinitionRef</span><span> </span><span class="hs-string">&quot;description in section with errors&quot;</span><span> </span><span class="hs-special">(</span><a href="Lorentz.Errors.html#DError"><span class="hs-identifier hs-var">DError</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426380"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-557"></a><span>
</span><a name="line-558"></a><span class="hs-comment">-- | This is to be included on top of @Errors@ section of the generated</span><span>
</span><a name="line-559"></a><span class="hs-comment">-- documentation.</span><span>
</span><a name="line-560"></a><span class="hs-identifier">errorsDocumentation</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Markdown</span><span>
</span><a name="line-561"></a><a name="errorsDocumentation"><a href="Lorentz.Errors.html#errorsDocumentation"><span class="hs-identifier">errorsDocumentation</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-562"></a><span>  </span><span class="hs-comment">-- Note: this description should remain general enough to fit into all our</span><span>
</span><a name="line-563"></a><span>  </span><span class="hs-comment">-- error formats, seek for [error format] to find all the relevant</span><span>
</span><a name="line-564"></a><span>  </span><span class="hs-comment">-- declarations.</span><span>
</span><a name="line-565"></a><span>  </span><span class="">[md|
  Our contract implies the possibility of error scenarios, this section enlists
  all values which the contract can produce via calling `FAILWITH` instruction
  on them. In case of error, no changes to contract state will be applied.

  Each entrypoint also contains a list of errors which can be raised during its
  execution; only for no-throw entrypoints this list will be omitted.
  Errors in these lists are placed in the order in which the corresponding
  properties are checked unless the opposite is specified. I.e., if for a
  given entrypoint call two different errors may take place, the one which
  appears in the list first will be thrown.

  Most of the errors are represented according to the same
  `(error tag, error argument)` pattern. See the list of errors below
  for details.

  We distinquish several error classes:
  + #{mdBold $ build ErrClassActionException}: given action cannot be performed with
    regard to the current contract state.

    Examples: &quot;insufficient balance&quot;, &quot;wallet does not exist&quot;.

    If you are implementing a middleware, such errors should be propagated to
    the client.

  + #{mdBold $ build ErrClassBadArgument}: invalid argument supplied to the entrypoint.

    Examples: entrypoint accepts a natural number from `0-3` range, and you
    supply `5`.

    If you are implementing a middleware, you should care about not letting
    such errors happen.

  + #{mdBold $ build ErrClassContractInternal}: contract-internal error.

    In ideal case, such errors should not take place, but still, make sure
    that you are ready to handle them. They can signal either invalid contract
    deployment or a bug in contract implementation.

    If an internal error is thrown, please report it to the author of this contract.
  |]</span><span>
</span><a name="line-606"></a><span>
</span><a name="line-607"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-608"></a><span class="hs-comment">-- Old interface (DEPRECATED)</span><span>
</span><a name="line-609"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-610"></a><span>
</span><a name="line-611"></a><span class="hs-comment">{- This API implements an approach when errors are declared via datatype
with constructors corresponding to error scenarios.
-}</span><span>
</span><a name="line-614"></a><span>
</span><a name="line-615"></a><span class="hs-comment">-- | Implementation of 'errorToVal' for custom errors.</span><span>
</span><a name="line-616"></a><span class="hs-identifier">customErrorToVal</span><span>
</span><a name="line-617"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LooseSumC</span><span> </span><a href="#local-6989586621679426377"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">HasCallStack</span><span class="hs-special">)</span><span>
</span><a name="line-618"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679426377"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-619"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679426379"><a href="#local-6989586621679426379"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><a href="Lorentz.Errors.html#ErrorScope"><span class="hs-identifier hs-type">ErrorScope</span></a><span> </span><a href="#local-6989586621679426379"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Value</span><span> </span><a href="#local-6989586621679426379"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679426378"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-620"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679426378"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-621"></a><a name="customErrorToVal"><a href="Lorentz.Errors.html#customErrorToVal"><span class="hs-identifier">customErrorToVal</span></a></a><span> </span><a name="local-6989586621679426800"><a href="#local-6989586621679426800"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679426801"><a href="#local-6989586621679426801"><span class="hs-identifier">cont</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-622"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">toTaggedVal</span><span> </span><a href="#local-6989586621679426800"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-623"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679426802"><a href="#local-6989586621679426802"><span class="hs-identifier">tag</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">SomeValue</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679426804"><a href="#local-6989586621679426804"><span class="hs-identifier">datVal</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Value</span><span> </span><a href="#local-6989586621679426803"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-624"></a><span>      </span><span class="hs-comment">-- Tags come from constructors names, so we can assume</span><span>
</span><a name="line-625"></a><span>      </span><span class="hs-comment">-- the event of weird chars occurrence to be quite improbable</span><span>
</span><a name="line-626"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679426805"><a href="#local-6989586621679426805"><span class="hs-identifier">tag'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkMTextUnsafe</span><span> </span><a href="#local-6989586621679426802"><span class="hs-identifier hs-var">tag</span></a><span>
</span><a name="line-627"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">opAbsense</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sing</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426803"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">bigMapAbsense</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sing</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426803"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">contractTypeAbsense</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sing</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426803"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-628"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Dict</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Dict</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Dict</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679426801"><span class="hs-identifier hs-var">cont</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">VPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VC</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CvString</span><span> </span><a href="#local-6989586621679426805"><span class="hs-identifier hs-var">tag'</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679426804"><span class="hs-identifier hs-var">datVal</span></a><span class="hs-special">)</span><span>
</span><a name="line-629"></a><span>
</span><a name="line-630"></a><span>        </span><span class="hs-comment">-- We could check this at type-level, but this would require</span><span>
</span><a name="line-631"></a><span>        </span><span class="hs-comment">-- specializing 'Michelson.Typed.LooseSum' to errors.</span><span>
</span><a name="line-632"></a><span>        </span><span class="hs-comment">-- We can do so, or assume that no one will ever try to put 'Operation'</span><span>
</span><a name="line-633"></a><span>        </span><span class="hs-comment">-- to error datatypes:</span><span>
</span><a name="line-634"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Operation in constructor data&quot;</span><span>
</span><a name="line-635"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;BigMap in constructor data&quot;</span><span>
</span><a name="line-636"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Contract in constructor data&quot;</span><span>
</span><a name="line-637"></a><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">customErrorToVal</span><span> </span><span class="hs-pragma">&quot;Datatype error declarations has been deprecated&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-638"></a><span>
</span><a name="line-639"></a><span class="hs-comment">-- | Implementation of 'errorFromVal' for custom errors.</span><span>
</span><a name="line-640"></a><span class="hs-comment">--</span><span>
</span><a name="line-641"></a><span class="hs-comment">-- This function is deprecated.</span><span>
</span><a name="line-642"></a><span class="hs-identifier">customErrorFromVal</span><span>
</span><a name="line-643"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679426214"><a href="#local-6989586621679426214"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679426215"><a href="#local-6989586621679426215"><span class="hs-identifier">e</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-644"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SingI</span><span> </span><a href="#local-6989586621679426214"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">LooseSumC</span><span> </span><a href="#local-6989586621679426215"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-645"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Value</span><span> </span><a href="#local-6989586621679426214"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><a href="#local-6989586621679426215"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-646"></a><a name="customErrorFromVal"><a href="Lorentz.Errors.html#customErrorFromVal"><span class="hs-identifier">customErrorFromVal</span></a></a><span> </span><a name="local-6989586621679426806"><a href="#local-6989586621679426806"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679426806"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">sing</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426214"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-647"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VC</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CvString</span><span> </span><a name="local-6989586621679426807"><a href="#local-6989586621679426807"><span class="hs-identifier">tag</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679426808"><a href="#local-6989586621679426808"><span class="hs-identifier">datVal</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">STPair</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-648"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">fromTaggedVal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toText</span><span> </span><a href="#local-6989586621679426807"><span class="hs-identifier hs-var">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">SomeValue</span><span> </span><a href="#local-6989586621679426808"><span class="hs-identifier hs-var">datVal</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-649"></a><span>      </span><span class="hs-identifier hs-var">ComposeOk</span><span> </span><a name="local-6989586621679426809"><a href="#local-6989586621679426809"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-650"></a><span>        </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679426809"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-651"></a><span>      </span><span class="hs-identifier hs-var">ComposeCtorNotFound</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-652"></a><span>        </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Unknown error constructor &quot;</span><span> </span><span class="hs-operator hs-var">+|</span><span> </span><a href="#local-6989586621679426807"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-operator hs-var">|+</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-653"></a><span>      </span><span class="hs-identifier hs-var">ComposeFieldTypeMismatch</span><span> </span><a name="local-6989586621679426810"><a href="#local-6989586621679426810"><span class="hs-identifier">got</span></a></a><span> </span><a name="local-6989586621679426811"><a href="#local-6989586621679426811"><span class="hs-identifier">expected</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-654"></a><span>        </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Error data type mismatch, expected &quot;</span><span> </span><span class="hs-operator hs-var">+||</span><span> </span><a href="#local-6989586621679426811"><span class="hs-identifier hs-var">expected</span></a><span> </span><span class="hs-operator hs-var">||+</span><span>
</span><a name="line-655"></a><span>                                            </span><span class="hs-string">&quot;, got &quot;</span><span> </span><span class="hs-operator hs-var">+||</span><span> </span><a href="#local-6989586621679426810"><span class="hs-identifier hs-var">got</span></a><span> </span><span class="hs-operator hs-var">||+</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-656"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Expected a (tag, dat) pair representing error&quot;</span><span>
</span><a name="line-657"></a><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">customErrorFromVal</span><span> </span><span class="hs-pragma">&quot;Datatype error declarations has been deprecated&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-658"></a><span>
</span><a name="line-659"></a><span class="hs-comment">-- | Prompt an error message saying that 'IsoValue' is not applicable for this type.</span><span>
</span><a name="line-660"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="CustomErrorNoIsoValue"><a href="Lorentz.Errors.html#CustomErrorNoIsoValue"><span class="hs-identifier">CustomErrorNoIsoValue</span></a></a><span> </span><a name="local-6989586621679425984"><a href="#local-6989586621679425984"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-661"></a><span>  </span><span class="hs-identifier">CustomErrorNoIsoValue</span><span> </span><a href="#local-6989586621679425985"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span>
</span><a name="line-662"></a><span>    </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;No IsoValue instance for &quot;</span><span> </span><span class="hs-special">'</span><span class="hs-operator hs-type">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><a href="#local-6989586621679425985"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">'</span><span class="hs-operator">:$$:</span><span>
</span><a name="line-663"></a><span>     </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;It has custom error representation&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-664"></a><span>
</span><a name="line-665"></a><span class="hs-comment">-- | Derive 'IsError' instance for given type.</span><span>
</span><a name="line-666"></a><span class="hs-comment">--</span><span>
</span><a name="line-667"></a><span class="hs-comment">-- This will also forbid deriving 'IsoValue' instance for that type to avoid</span><span>
</span><a name="line-668"></a><span class="hs-comment">-- having multiple different Michelson representations.</span><span>
</span><a name="line-669"></a><span class="hs-identifier">deriveCustomError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Dec</span><span class="hs-special">]</span><span>
</span><a name="line-670"></a><a name="deriveCustomError"><a href="Lorentz.Errors.html#deriveCustomError"><span class="hs-identifier">deriveCustomError</span></a></a><span> </span><a name="local-6989586621679426812"><a href="#local-6989586621679426812"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-671"></a><span>  </span><span class="hs-special">[d|</span><span>
</span><a name="line-672"></a><span>    </span><span class="hs-keyword">instance</span><span> </span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><span class="">$ty</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-673"></a><span>      </span><a name="errorToVal"><a href="Lorentz.Errors.html#errorToVal"><span class="hs-identifier">errorToVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#customErrorToVal"><span class="hs-identifier hs-var">customErrorToVal</span></a><span>
</span><a name="line-674"></a><span>      </span><a name="errorFromVal"><a href="Lorentz.Errors.html#errorFromVal"><span class="hs-identifier">errorFromVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#customErrorFromVal"><span class="hs-identifier hs-var">customErrorFromVal</span></a><span>
</span><a name="line-675"></a><span>
</span><a name="line-676"></a><span>    </span><span class="hs-keyword">instance</span><span> </span><a href="Lorentz.Errors.html#CustomErrorNoIsoValue"><span class="hs-identifier hs-type">CustomErrorNoIsoValue</span></a><span> </span><span class="">$ty</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">IsoValue</span><span> </span><span class="">$ty</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-677"></a><span>      </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ToT</span><span> </span><span class="">$ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#CustomErrorNoIsoValue"><span class="hs-identifier hs-type">CustomErrorNoIsoValue</span></a><span> </span><span class="">$ty</span><span>
</span><a name="line-678"></a><span>      </span><a name="toVal"><span class="hs-identifier">toVal</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;impossible&quot;</span><span>
</span><a name="line-679"></a><span>      </span><a name="fromVal"><span class="hs-identifier">fromVal</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;impossible&quot;</span><span>
</span><a name="line-680"></a><span>
</span><a name="line-681"></a><span>    </span><span class="hs-keyword">instance</span><span> </span><a href="Lorentz.Errors.html#ErrorHasDoc"><span class="hs-identifier hs-type">ErrorHasDoc</span></a><span> </span><span class="">$ty</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-682"></a><span>      </span><a name="errorDocName"><a href="Lorentz.Errors.html#errorDocName"><span class="hs-identifier">errorDocName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Some error&quot;</span><span>
</span><a name="line-683"></a><span>      </span><a name="errorDocMdCause"><a href="Lorentz.Errors.html#errorDocMdCause"><span class="hs-identifier">errorDocMdCause</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;An error occurred.&quot;</span><span>
</span><a name="line-684"></a><span>      </span><a name="errorDocHaskellRep"><a href="Lorentz.Errors.html#errorDocHaskellRep"><span class="hs-identifier">errorDocHaskellRep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-&quot;</span><span>
</span><a name="line-685"></a><span>      </span><a name="errorDocClass"><a href="Lorentz.Errors.html#errorDocClass"><span class="hs-identifier">errorDocClass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lorentz.Errors.html#ErrClassUnknown"><span class="hs-identifier hs-var">ErrClassUnknown</span></a><span>
</span><a name="line-686"></a><span>      </span><a name="errorDocDependencies"><a href="Lorentz.Errors.html#errorDocDependencies"><span class="hs-identifier">errorDocDependencies</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-687"></a><span>  </span><span class="hs-special">|]</span><span>
</span><a name="line-688"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-689"></a><span>    </span><a name="local-6989586621679426813"><a href="#local-6989586621679426813"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.ConT</span><span> </span><a href="#local-6989586621679426812"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-690"></a><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">deriveCustomError</span><span> </span><span class="hs-pragma">&quot;Datatype error declarations has been deprecated&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-691"></a><span>
</span><a name="line-692"></a><span class="hs-comment">-- | Signature of 'userFailWith'.</span><span>
</span><a name="line-693"></a><span class="hs-keyword">type</span><span> </span><a name="FailUsingArg"><a href="Lorentz.Errors.html#FailUsingArg"><span class="hs-identifier">FailUsingArg</span></a></a><span> </span><a name="local-6989586621679425979"><a href="#local-6989586621679425979"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679425980"><a href="#local-6989586621679425980"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679425981"><a href="#local-6989586621679425981"><span class="hs-identifier">fieldTy</span></a></a><span> </span><a name="local-6989586621679425982"><a href="#local-6989586621679425982"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679425983"><a href="#local-6989586621679425983"><span class="hs-identifier">s'</span></a></a><span>
</span><a name="line-694"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">KnownSymbol</span><span> </span><a href="#local-6989586621679425980"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">,</span><span> </span><a href="Lorentz.Errors.html#IsError"><span class="hs-identifier hs-type">IsError</span></a><span> </span><a href="#local-6989586621679425979"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-695"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">IsoValue</span><span> </span><a href="#local-6989586621679425981"><span class="hs-identifier hs-type">fieldTy</span></a><span>
</span><a name="line-696"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CtorHasOnlyField</span><span> </span><a href="#local-6989586621679425980"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679425979"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679425981"><span class="hs-identifier hs-type">fieldTy</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Each</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SingI</span><span class="hs-special">]</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-identifier hs-type">ToT</span><span> </span><a href="#local-6989586621679425981"><span class="hs-identifier hs-type">fieldTy</span></a><span class="hs-special">]</span><span>
</span><a name="line-697"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">HasCallStack</span><span>
</span><a name="line-698"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-699"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Label</span><span> </span><a href="#local-6989586621679425980"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lorentz.Base.html#%3A-%3E"><span class="hs-identifier hs-type">fieldTy</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679425982"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-operator">:-&gt;</span><span> </span><a href="#local-6989586621679425983"><span class="hs-identifier hs-type">s'</span></a><span>
</span><a name="line-700"></a><span>
</span><a name="line-701"></a><span class="hs-comment">-- | Fail with given error, picking argument for error from the top</span><span>
</span><a name="line-702"></a><span class="hs-comment">-- of the stack.</span><span>
</span><a name="line-703"></a><span class="hs-comment">--</span><span>
</span><a name="line-704"></a><span class="hs-comment">-- If your error constructor does not carry an argument, use 'failUsing'</span><span>
</span><a name="line-705"></a><span class="hs-comment">-- function instead.</span><span>
</span><a name="line-706"></a><span class="hs-comment">-- Consider the following practice: once error datatype for your contract</span><span>
</span><a name="line-707"></a><span class="hs-comment">-- is defined, create a specialization of this function to the error type.</span><span>
</span><a name="line-708"></a><span class="hs-comment">--</span><span>
</span><a name="line-709"></a><span class="hs-comment">-- This function is deprecated.</span><span>
</span><a name="line-710"></a><span class="hs-identifier">failUsingArg</span><span>
</span><a name="line-711"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679426209"><a href="#local-6989586621679426209"><span class="hs-identifier">err</span></a></a><span> </span><a name="local-6989586621679426210"><a href="#local-6989586621679426210"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679426211"><a href="#local-6989586621679426211"><span class="hs-identifier">fieldTy</span></a></a><span> </span><a name="local-6989586621679426212"><a href="#local-6989586621679426212"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679426213"><a href="#local-6989586621679426213"><span class="hs-identifier">s'</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-712"></a><span>     </span><a href="Lorentz.Errors.html#FailUsingArg"><span class="hs-identifier hs-type">FailUsingArg</span></a><span> </span><a href="#local-6989586621679426209"><span class="hs-identifier hs-type">err</span></a><span> </span><a href="#local-6989586621679426210"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679426211"><span class="hs-identifier hs-type">fieldTy</span></a><span> </span><a href="#local-6989586621679426212"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679426213"><span class="hs-identifier hs-type">s'</span></a><span>
</span><a name="line-713"></a><a name="failUsingArg"><a href="Lorentz.Errors.html#failUsingArg"><span class="hs-identifier">failUsingArg</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-714"></a><span>  </span><a href="Lorentz.Instr.html#push"><span class="hs-identifier hs-var">push</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkMTextUnsafe</span><span> </span><a href="#local-6989586621679426820"><span class="hs-identifier hs-var">ctor</span></a><span class="hs-special">)</span><span> </span><a href="Lorentz.Base.html#%23"><span class="hs-operator hs-var">#</span></a><span>
</span><a name="line-715"></a><span>  </span><a href="Lorentz.Instr.html#pair"><span class="hs-identifier hs-var">pair</span></a><span> </span><a href="Lorentz.Base.html#%23"><span class="hs-operator hs-var">#</span></a><span>
</span><a name="line-716"></a><span>  </span><a href="Lorentz.Instr.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span>
</span><a name="line-717"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-718"></a><span>    </span><a name="local-6989586621679426820"><a href="#local-6989586621679426820"><span class="hs-identifier">ctor</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">symbolVal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679426210"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-719"></a><span>      </span><span class="hs-char">'c'</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679426821"><a href="#local-6989586621679426821"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toText</span><span> </span><a href="#local-6989586621679426821"><span class="hs-identifier hs-var">other</span></a><span>
</span><a name="line-720"></a><span>      </span><a name="local-6989586621679426822"><a href="#local-6989586621679426822"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Bad label provided: &quot;</span><span> </span><span class="hs-operator hs-var">+|</span><span> </span><a href="#local-6989586621679426822"><span class="hs-identifier hs-var">other</span></a><span> </span><span class="hs-operator hs-var">|+</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-721"></a><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">failUsingArg</span><span> </span><span class="hs-pragma">&quot;Datatype error declarations has been deprecated&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-722"></a></pre></body></html>